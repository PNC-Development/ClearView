<%@ Control Language="C#" %>
<script runat="server">
    private DataSet ds;
    private string dsn = ConfigurationManager.ConnectionStrings[ConfigurationManager.AppSettings["DSN"]].ConnectionString;
    private int intEnvironment = Int32.Parse(ConfigurationManager.AppSettings["Environment"]);
    private string strVirtual = ConfigurationManager.AppSettings["VirtualGatekeeper"];
    private int intAssignPage = Int32.Parse(ConfigurationManager.AppSettings["AssignWorkload"]);
    private int intResourceRequestApprove = Int32.Parse(ConfigurationManager.AppSettings["ResourceRequestApprove"]);
    private int intViewRequest = Int32.Parse(ConfigurationManager.AppSettings["ViewRequest"]);
    private int intViewResourceRequest = Int32.Parse(ConfigurationManager.AppSettings["ResourceRequest"]);
    private int intWorkloadManager = Int32.Parse(ConfigurationManager.AppSettings["ViewWorkload"]);
    private int intCSRCPage = Int32.Parse(ConfigurationManager.AppSettings["CSRC_WORKFLOW"]);
    private int intPCRPage = Int32.Parse(ConfigurationManager.AppSettings["PCR_WORKFLOW"]);
    private string strBCC = ConfigurationManager.AppSettings["WorkflowBCC"];
    private int intProfile;
    private Projects oProject;
    private Functions oFunction;
    private Users oUser;
    private Pages oPage;
    private ResourceRequest oResourceRequest;
    private RequestItems oRequestItem;
    private Requests oRequest;
    private StatusLevels oStatus;
    private ServiceRequests oServiceRequest;
    private Applications oApplication;
    private Documents oDocument;
    private RequestFields oRequestField;
    private ProjectRequest oProjectRequest;
    private Variables oVariable;
    private TPM oTPM;
    private int intApplication = 0;
    private int intPage = 0;
    private int intProject = 0;
    private bool boolDetails = false;
    private bool boolStatus = false;
    private bool boolInformation = false;
    private bool boolClose = false;
    private int intRequest = 0;
    private int intItem = 0;
    private int intNumber = 0;
    private int intLead = 0;
    private string strCSRC = "";
    private string strPCR = "";
    private int intWorking = 0;
    private int intExecutive = 0;
    private void Page_Load()
    {
        intProfile = Int32.Parse(Request.Cookies["profileid"].Value);
        oProject = new Projects(intProfile, dsn);
        oFunction = new Functions(intProfile, dsn, intEnvironment);
        oUser = new Users(intProfile, dsn);
        oPage = new Pages(intProfile, dsn);
        oResourceRequest = new ResourceRequest(intProfile, dsn);
        oRequestItem = new RequestItems(intProfile, dsn);
        oRequest = new Requests(intProfile, dsn);
        oStatus = new StatusLevels();
        oServiceRequest = new ServiceRequests(intProfile, dsn);
        oApplication = new Applications(intProfile, dsn);
        oDocument = new Documents(intProfile, dsn);
        oRequestField = new RequestFields(intProfile, dsn);
        oProjectRequest = new ProjectRequest(intProfile, dsn);
        oVariable = new Variables(intEnvironment);
        oTPM = new TPM(intProfile, dsn, intEnvironment);
        if (Request.QueryString["applicationid"] != null && Request.QueryString["applicationid"] != "")
            intApplication = Int32.Parse(Request.QueryString["applicationid"]);
        if (Request.QueryString["pageid"] != null && Request.QueryString["pageid"] != "")
            intPage = Int32.Parse(Request.QueryString["pageid"]);
        if (Request.Cookies["application"] != null && Request.Cookies["application"].Value != "")
            intApplication = Int32.Parse(Request.Cookies["application"].Value);
        if (Request.QueryString["rrid"] != null && Request.QueryString["rrid"] != "")
        {
            lblRequest.Text = Request.QueryString["rrid"];
            int intResource = Int32.Parse(Request.QueryString["rrid"]);
            ds = oResourceRequest.Get(intResource);
            intRequest = Int32.Parse(ds.Tables[0].Rows[0]["requestid"].ToString());
            intItem = Int32.Parse(ds.Tables[0].Rows[0]["itemid"].ToString());
            intNumber = Int32.Parse(ds.Tables[0].Rows[0]["number"].ToString());
            int intUser = Int32.Parse(ds.Tables[0].Rows[0]["userid"].ToString());
            intLead = oUser.GetManager(intProfile, true);
            if (intProfile == intUser)
            {
                intProject = oRequest.GetProjectNumber(intRequest);
                lblDocuments.Text = oDocument.GetDocuments(Request.PhysicalApplicationPath, "uploads\\projects\\" + intProject.ToString() + "\\", "/uploads/projects/" + intProject.ToString() + "/");
                if (ds.Tables[0].Rows[0]["solo"].ToString() == "0")
                {
                    intWorking = Int32.Parse(oProjectRequest.Get(intRequest, "working"));
                    intExecutive = Int32.Parse(oProjectRequest.Get(intRequest, "executive"));
                    lblSubmitted.Text = DateTime.Parse(oProjectRequest.Get(intRequest, "created")).ToShortDateString();
                    hypView.Text = "View Original Project Request";
                    hypView.NavigateUrl = oPage.GetFullLink(intViewRequest) + "?rid=" + intRequest.ToString();
                }
                else
                {
                    intWorking = oUser.GetIdName(oRequestField.GetItemValue(intResource, 10000));
                    intExecutive = oUser.GetIdName(oRequestField.GetItemValue(intResource, 10038));
                    lblSubmitted.Text = DateTime.Parse(oRequest.Get(intRequest, "modified")).ToShortDateString();
                    hypView.Text = "View Original Request Details";
                    hypView.NavigateUrl = oPage.GetFullLink(intViewResourceRequest) + "?rrid=" + intResource.ToString();
                }
                txtWorking.Text = oUser.GetFullName(intWorking) + " (" + oUser.GetName(intWorking) + ")";
                txtExecutive.Text = oUser.GetFullName(intExecutive) + " (" + oUser.GetName(intExecutive) + ")";
                lblCSRCW.Text = oUser.GetFullName(intWorking);
                lblCSRCE.Text = oUser.GetFullName(intExecutive);
                lblPCRW.Text = oUser.GetFullName(intWorking);
                lblPCRE.Text = oUser.GetFullName(intExecutive);
                lblExecutive.Text = oUser.GetFullName(intExecutive);
                lblWorking.Text = oUser.GetFullName(intWorking);
                oFunction.ConfigureToolButton(btnComplete, "/images/tool_complete");
                btnComplete.Attributes.Add("onclick", "return confirm('Are you sure you want to mark this as completed and remove it from your workload?');");
                if (oService.Get(intService, "sla") != "")
                {
                    oFunction.ConfigureToolButton(btnSLA, "/images/tool_sla");
                    btnSLA.Attributes.Add("onclick", "return OpenWindow('RESOURCE_REQUEST_SLA','?rrid=" + intResource.ToString() + "');");
                }
                else
                {
                    btnSLA.ImageUrl = "/images/tool_sla_dbl.gif";
                    btnSLA.Enabled = false;
                }
                oFunction.ConfigureToolButton(btnEmail, "/images/tool_email");
                btnEmail.Attributes.Add("onclick", "return OpenWindow('RESOURCE_REQUEST_EMAIL','?rrid=" + intResource.ToString() + "');");
                oFunction.ConfigureToolButton(btnSave, "/images/tool_save");
                oFunction.ConfigureToolButton(btnPrint, "/images/tool_print");
                btnPrint.Attributes.Add("onclick", "return PrintWindow();");
                oFunction.ConfigureToolButton(btnClose, "/images/tool_close");
                btnClose.Attributes.Add("onclick", "return ExitWindow();");
                if (Request.QueryString["save"] != null && Request.QueryString["save"] != "")
                    Page.ClientScript.RegisterClientScriptBlock(typeof(Page), "saved", "<script type=\"text/javascript\">alert('Information Saved Successfully');<" + "/" + "script>");
                hdnTab.Value = "D";
                panWorkload.Visible = true;
                LoadStatus(intResource);
                if (!IsPostBack)
                {
                    LoadLists();
                    LoadProject(intResource);
                    LoadCSRC();
                    LoadPCR();
                    lblPriority.Text = oProjectRequest.GetPriority(intRequest);
                }
                lblTeamLeadCSRC.Text = oUser.GetFullName(intLead);
                lblTeamLeadPCR.Text = oUser.GetFullName(intLead);
            }
            else
                panDenied.Visible = true;
            btnDenied.Attributes.Add("onclick", "return CloseWindow();");
            btnSave.Attributes.Add("onclick", "return ValidateStatusTPM('" + ddlScope.ClientID + "','" + ddlTimeline.ClientID + "','" + ddlBudget.ClientID + "','" + txtStatusDate.ClientID + "','" + txtComments.ClientID + "','" + txtThisWeek.ClientID + "','" + txtNextWeek.ClientID + "');");
            btnStrategic.Attributes.Add("onclick", "return ShowDocuments('PROJECTS','" + intProject + "','0');");
            btnCostAdd.Attributes.Add("onclick", "return MoveList('" + lstCostsAvailable.ClientID + "','" + lstCostsCurrent.ClientID + "','" + CV_FIELD_10059.ClientID + "','" + lstCostsCurrent.ClientID + "');");
            lstCostsAvailable.Attributes.Add("ondblclick", "return MoveList('" + lstCostsAvailable.ClientID + "','" + lstCostsCurrent.ClientID + "','" + CV_FIELD_10059.ClientID + "','" + lstCostsCurrent.ClientID + "');");
            btnCostRemove.Attributes.Add("onclick", "return MoveList('" + lstCostsCurrent.ClientID + "','" + lstCostsAvailable.ClientID + "','" + CV_FIELD_10059.ClientID + "','" + lstCostsCurrent.ClientID + "');");
            lstCostsCurrent.Attributes.Add("ondblclick", "return MoveList('" + lstCostsCurrent.ClientID + "','" + lstCostsAvailable.ClientID + "','" + CV_FIELD_10059.ClientID + "','" + lstCostsCurrent.ClientID + "');");
            // Dates
            imgCV_FIELD_10044.Attributes.Add("onclick", "return ShowCalendar('" + CV_FIELD_10044.ClientID + "');");
            imgCV_FIELD_10045.Attributes.Add("onclick", "return ShowCalendar('" + CV_FIELD_10045.ClientID + "');");
            imgCV_FIELD_10046.Attributes.Add("onclick", "return ShowCalendar('" + CV_FIELD_10046.ClientID + "');");
            imgCV_FIELD_10047.Attributes.Add("onclick", "return ShowCalendar('" + CV_FIELD_10047.ClientID + "');");
            imgCV_FIELD_10048.Attributes.Add("onclick", "return ShowCalendar('" + CV_FIELD_10048.ClientID + "');");
            imgCV_FIELD_10049.Attributes.Add("onclick", "return ShowCalendar('" + CV_FIELD_10049.ClientID + "');");
            imgCV_FIELD_10050.Attributes.Add("onclick", "return ShowCalendar('" + CV_FIELD_10050.ClientID + "');");
            imgCV_FIELD_10051.Attributes.Add("onclick", "return ShowCalendar('" + CV_FIELD_10051.ClientID + "');");
            imgCV_FIELD_10112.Attributes.Add("onclick", "return ShowCalendar('" + CV_FIELD_10112.ClientID + "');");
            imgCV_FIELD_10113.Attributes.Add("onclick", "return ShowCalendar('" + CV_FIELD_10113.ClientID + "');");
            imgCV_FIELD_10114.Attributes.Add("onclick", "return ShowCalendar('" + CV_FIELD_10114.ClientID + "');");
            imgCV_FIELD_10115.Attributes.Add("onclick", "return ShowCalendar('" + CV_FIELD_10115.ClientID + "');");
            imgCV_FIELD_10116.Attributes.Add("onclick", "return ShowCalendar('" + CV_FIELD_10116.ClientID + "');");
            imgCV_FIELD_10117.Attributes.Add("onclick", "return ShowCalendar('" + CV_FIELD_10117.ClientID + "');");
            imgCV_FIELD_10118.Attributes.Add("onclick", "return ShowCalendar('" + CV_FIELD_10118.ClientID + "');");
            imgCV_FIELD_10119.Attributes.Add("onclick", "return ShowCalendar('" + CV_FIELD_10119.ClientID + "');");
            // Calculators
            imgCV_FIELD_10120.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10120.ClientID + "');");
            imgCV_FIELD_10121.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10121.ClientID + "');");
            imgCV_FIELD_10122.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10122.ClientID + "');");
            imgCV_FIELD_10123.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10123.ClientID + "');");
            imgCV_FIELD_10124.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10124.ClientID + "');");
            imgCV_FIELD_10125.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10125.ClientID + "');");
            imgCV_FIELD_10126.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10126.ClientID + "');");
            imgCV_FIELD_10127.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10127.ClientID + "');");
            imgCV_FIELD_10128.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10128.ClientID + "');");
            imgCV_FIELD_10129.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10129.ClientID + "');");
            imgCV_FIELD_10130.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10130.ClientID + "');");
            imgCV_FIELD_10131.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10131.ClientID + "');");
            imgCV_FIELD_10132.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10132.ClientID + "');");
            imgCV_FIELD_10133.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10133.ClientID + "');");
            imgCV_FIELD_10134.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10134.ClientID + "');");
            imgCV_FIELD_10135.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10135.ClientID + "');");
            imgCV_FIELD_10136.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10136.ClientID + "');");
            imgCV_FIELD_10137.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10137.ClientID + "');");
            imgCV_FIELD_10138.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10138.ClientID + "');");
            imgCV_FIELD_10139.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10139.ClientID + "');");
            imgCV_FIELD_10140.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10140.ClientID + "');");
            imgCV_FIELD_10141.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10141.ClientID + "');");
            imgCV_FIELD_10142.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10142.ClientID + "');");
            imgCV_FIELD_10143.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10143.ClientID + "');");
            imgCV_FIELD_10144.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10144.ClientID + "');");
            imgCV_FIELD_10145.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10145.ClientID + "');");
            imgCV_FIELD_10146.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10146.ClientID + "');");
            imgCV_FIELD_10147.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10147.ClientID + "');");
            imgCV_FIELD_10148.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10148.ClientID + "');");
            imgCV_FIELD_10149.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10149.ClientID + "');");
            imgCV_FIELD_10150.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10150.ClientID + "');");
            imgCV_FIELD_10151.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10151.ClientID + "');");
            imgCV_FIELD_10152.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10152.ClientID + "');");
            imgCV_FIELD_10153.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10153.ClientID + "');");
            imgCV_FIELD_10154.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10154.ClientID + "');");
            imgCV_FIELD_10155.Attributes.Add("onclick", "return ShowCalculator('" + CV_FIELD_10155.ClientID + "');");
            imgCSRCEC.Attributes.Add("onclick", "return ShowCalendar('" + txtCSRCEC.ClientID + "');");
            imgCSRCED.Attributes.Add("onclick", "return ShowCalendar('" + txtCSRCED.ClientID + "');");
            imgCSRCEE.Attributes.Add("onclick", "return ShowCalendar('" + txtCSRCEE.ClientID + "');");
            imgCSRCEP.Attributes.Add("onclick", "return ShowCalendar('" + txtCSRCEP.ClientID + "');");
            imgCSRCExC.Attributes.Add("onclick", "return ShowCalculator('" + txtCSRCExC.ClientID + "');");
            imgCSRCExD.Attributes.Add("onclick", "return ShowCalculator('" + txtCSRCExD.ClientID + "');");
            imgCSRCExE.Attributes.Add("onclick", "return ShowCalculator('" + txtCSRCExE.ClientID + "');");
            imgCSRCExP.Attributes.Add("onclick", "return ShowCalculator('" + txtCSRCExP.ClientID + "');");
            imgCSRCHC.Attributes.Add("onclick", "return ShowCalculator('" + txtCSRCHC.ClientID + "');");
            imgCSRCHD.Attributes.Add("onclick", "return ShowCalculator('" + txtCSRCHD.ClientID + "');");
            imgCSRCHE.Attributes.Add("onclick", "return ShowCalculator('" + txtCSRCHE.ClientID + "');");
            imgCSRCHP.Attributes.Add("onclick", "return ShowCalculator('" + txtCSRCHP.ClientID + "');");
            imgCSRCIC.Attributes.Add("onclick", "return ShowCalculator('" + txtCSRCIC.ClientID + "');");
            imgCSRCID.Attributes.Add("onclick", "return ShowCalculator('" + txtCSRCID.ClientID + "');");
            imgCSRCIE.Attributes.Add("onclick", "return ShowCalculator('" + txtCSRCIE.ClientID + "');");
            imgCSRCIP.Attributes.Add("onclick", "return ShowCalculator('" + txtCSRCIP.ClientID + "');");
            imgCSRCSC.Attributes.Add("onclick", "return ShowCalendar('" + txtCSRCSC.ClientID + "');");
            imgCSRCSD.Attributes.Add("onclick", "return ShowCalendar('" + txtCSRCSD.ClientID + "');");
            imgCSRCSE.Attributes.Add("onclick", "return ShowCalendar('" + txtCSRCSE.ClientID + "');");
            imgCSRCSP.Attributes.Add("onclick", "return ShowCalendar('" + txtCSRCSP.ClientID + "');");
            imgPCRScheduleCE.Attributes.Add("onclick", "return ShowCalendar('" + txtPCRScheduleCE.ClientID + "');");
            imgPCRScheduleCS.Attributes.Add("onclick", "return ShowCalendar('" + txtPCRScheduleCS.ClientID + "');");
            imgPCRScheduleDE.Attributes.Add("onclick", "return ShowCalendar('" + txtPCRScheduleDE.ClientID + "');");
            imgPCRScheduleDS.Attributes.Add("onclick", "return ShowCalendar('" + txtPCRScheduleDS.ClientID + "');");
            imgPCRScheduleEE.Attributes.Add("onclick", "return ShowCalendar('" + txtPCRScheduleEE.ClientID + "');");
            imgPCRScheduleES.Attributes.Add("onclick", "return ShowCalendar('" + txtPCRScheduleES.ClientID + "');");
            imgPCRSchedulePE.Attributes.Add("onclick", "return ShowCalendar('" + txtPCRSchedulePE.ClientID + "');");
            imgPCRSchedulePS.Attributes.Add("onclick", "return ShowCalendar('" + txtPCRSchedulePS.ClientID + "');");
            imgPCRFinancialC.Attributes.Add("onclick", "return ShowCalculator('" + txtPCRFinancialC.ClientID + "');");
            imgPCRFinancialD.Attributes.Add("onclick", "return ShowCalculator('" + txtPCRFinancialD.ClientID + "');");
            imgPCRFinancialE.Attributes.Add("onclick", "return ShowCalculator('" + txtPCRFinancialE.ClientID + "');");
            imgPCRFinancialP.Attributes.Add("onclick", "return ShowCalculator('" + txtPCRFinancialP.ClientID + "');");
            imgStart.Attributes.Add("onclick", "return ShowCalendar('" + CV_FIELD_10043.ClientID + "');");
            imgStatusDate.Attributes.Add("onclick", "return ShowCalendar('" + txtStatusDate.ClientID + "');");
            txtWorking.Attributes.Add("onkeyup", "return AJAXTextBoxGet(this,'300','195','" + divWorking.ClientID + "','" + lstWorking.ClientID + "','" + hdnWorking.ClientID + "','" + oVariable.URL() + "/frame/users.aspx',2);");
            lstWorking.Attributes.Add("ondblclick", "AJAXClickRow();");
            txtExecutive.Attributes.Add("onkeyup", "return AJAXTextBoxGet(this,'300','195','" + divExecutive.ClientID + "','" + lstExecutive.ClientID + "','" + hdnExecutive.ClientID + "','" + oVariable.URL() + "/frame/users.aspx',2);");
            lstExecutive.Attributes.Add("ondblclick", "AJAXClickRow();");
            txtCSRCD.Attributes.Add("onkeyup", "return AJAXTextBoxGet(this,'300','195','" + divCSRCD.ClientID + "','" + lstCSRCD.ClientID + "','" + hdnCSRCD.ClientID + "','" + oVariable.URL() + "/frame/users.aspx',2);");
            lstCSRCD.Attributes.Add("ondblclick", "AJAXClickRow();");
            txtCSRCC.Attributes.Add("onkeyup", "return AJAXTextBoxGet(this,'300','195','" + divCSRCC.ClientID + "','" + lstCSRCC.ClientID + "','" + hdnCSRCC.ClientID + "','" + oVariable.URL() + "/frame/users.aspx',2);");
            lstCSRCC.Attributes.Add("ondblclick", "AJAXClickRow();");
            txtPCRD.Attributes.Add("onkeyup", "return AJAXTextBoxGet(this,'300','195','" + divPCRD.ClientID + "','" + lstPCRD.ClientID + "','" + hdnPCRD.ClientID + "','" + oVariable.URL() + "/frame/users.aspx',2);");
            lstPCRD.Attributes.Add("ondblclick", "AJAXClickRow();");
            txtPCRC.Attributes.Add("onkeyup", "return AJAXTextBoxGet(this,'300','195','" + divPCRC.ClientID + "','" + lstPCRC.ClientID + "','" + hdnPCRC.ClientID + "','" + oVariable.URL() + "/frame/users.aspx',2);");
            lstPCRC.Attributes.Add("ondblclick", "AJAXClickRow();");
            chkDiscovery.Attributes.Add("onclick", "CheckCSRC('" + chkDiscovery.ClientID + "','" + chkPlanning.ClientID + "','" + chkExecution.ClientID + "','" + chkClosing.ClientID + "','" + divCSRC.ClientID + "');ShowHideDivCheck('" + divDiscovery.ClientID + "',this);");
            chkPlanning.Attributes.Add("onclick", "CheckCSRC('" + chkDiscovery.ClientID + "','" + chkPlanning.ClientID + "','" + chkExecution.ClientID + "','" + chkClosing.ClientID + "','" + divCSRC.ClientID + "');ShowHideDivCheck('" + divPlanning.ClientID + "',this);");
            chkExecution.Attributes.Add("onclick", "CheckCSRC('" + chkDiscovery.ClientID + "','" + chkPlanning.ClientID + "','" + chkExecution.ClientID + "','" + chkClosing.ClientID + "','" + divCSRC.ClientID + "');ShowHideDivCheck('" + divExecution.ClientID + "',this);");
            chkClosing.Attributes.Add("onclick", "CheckCSRC('" + chkDiscovery.ClientID + "','" + chkPlanning.ClientID + "','" + chkExecution.ClientID + "','" + chkClosing.ClientID + "','" + divCSRC.ClientID + "');ShowHideDivCheck('" + divClosing.ClientID + "',this);");
            chkPCR.Attributes.Add("onclick", "ShowHideDivCheck('" + divPCR.ClientID + "',this);");
            chkSchedule.Attributes.Add("onclick", "ShowHideDivCheck('" + divSchedule.ClientID + "',this);");
            chkFinancial.Attributes.Add("onclick", "ShowHideDivCheck('" + divFinancial.ClientID + "',this);");
            chkReason.Attributes.Add("onclick", "ShowHideDivCheck('" + divReason.ClientID + "',this);");
            btnCSRC.Attributes.Add("onclick", "return ValidateCSRC('" + chkDiscovery.ClientID + "'" +
                ",'" + chkPlanning.ClientID + "'" +
                ",'" + chkExecution.ClientID + "'" +
                ",'" + chkClosing.ClientID + "'" +
                ",'" + oCSRC.ClientID + "'" +
                ",'" + txtCSRCSD.ClientID + "'" +
                ",'" + txtCSRCED.ClientID + "'" +
                ",'" + txtCSRCID.ClientID + "'" +
                ",'" + txtCSRCExD.ClientID + "'" +
                ",'" + txtCSRCHD.ClientID + "'" +
                ",'" + txtCSRCSP.ClientID + "'" +
                ",'" + txtCSRCEP.ClientID + "'" +
                ",'" + txtCSRCIP.ClientID + "'" +
                ",'" + txtCSRCExP.ClientID + "'" +
                ",'" + txtCSRCHP.ClientID + "'" +
                ",'" + txtCSRCSE.ClientID + "'" +
                ",'" + txtCSRCEE.ClientID + "'" +
                ",'" + txtCSRCIE.ClientID + "'" +
                ",'" + txtCSRCExE.ClientID + "'" +
                ",'" + txtCSRCHE.ClientID + "'" +
                ",'" + txtCSRCSC.ClientID + "'" +
                ",'" + txtCSRCEC.ClientID + "'" +
                ",'" + txtCSRCIC.ClientID + "'" +
                ",'" + txtCSRCExC.ClientID + "'" +
                ",'" + txtCSRCHC.ClientID + "'" +
                ");");
            btnPCR.Attributes.Add("onclick", "return ValidatePCR('" + chkScope.ClientID + "'" +
                ",'" + chkSchedule.ClientID + "'" +
                ",'" + chkPCRScheduleD.ClientID + "'" +
                ",'" + txtPCRScheduleDS.ClientID + "'" +
                ",'" + txtPCRScheduleDE.ClientID + "'" +
                ",'" + chkPCRScheduleP.ClientID + "'" +
                ",'" + txtPCRSchedulePS.ClientID + "'" +
                ",'" + txtPCRSchedulePE.ClientID + "'" +
                ",'" + chkPCRScheduleE.ClientID + "'" +
                ",'" + txtPCRScheduleES.ClientID + "'" +
                ",'" + txtPCRScheduleEE.ClientID + "'" +
                ",'" + chkPCRScheduleC.ClientID + "'" +
                ",'" + txtPCRScheduleCS.ClientID + "'" +
                ",'" + txtPCRScheduleCE.ClientID + "'" +
                ",'" + chkFinancial.ClientID + "'" +
                ",'" + chkPCRFinancialD.ClientID + "'" +
                ",'" + txtPCRFinancialD.ClientID + "'" +
                ",'" + chkPCRFinancialP.ClientID + "'" +
                ",'" + txtPCRFinancialP.ClientID + "'" +
                ",'" + chkPCRFinancialE.ClientID + "'" +
                ",'" + txtPCRFinancialE.ClientID + "'" +
                ",'" + chkPCRFinancialC.ClientID + "'" +
                ",'" + txtPCRFinancialC.ClientID + "'" +
                ",'" + oPCR.ClientID + "'" +
                ");");
        }
        else
            panDenied.Visible = true;
    }
    private void LoadLists()
    {
        Costs oCost = new Costs(intProfile, dsn);
        ds = oCost.Gets(1);
        lstCostsAvailable.DataValueField = "costid";
        lstCostsAvailable.DataTextField = "name";
        lstCostsAvailable.DataSource = ds;
        lstCostsAvailable.DataBind();
        Organizations oOrganization = new Organizations(intProfile, dsn);
        ds = oOrganization.Gets(1);
        ddlPortfolio.DataValueField = "organizationid";
        ddlPortfolio.DataTextField = "name";
        ddlPortfolio.DataSource = ds;
        ddlPortfolio.DataBind();
        ddlPortfolio.Items.Insert(0, new ListItem("-- SELECT --", "0"));
    }
    private void LoadStatus(int _resourceid)
    {
        DataSet dsStatus = oResourceRequest.GetStatussTPM(_resourceid);
        rptStatus.DataSource = dsStatus;
        rptStatus.DataBind();
        lblNoStatus.Visible = (rptStatus.Items.Count == 0);
        double dblTotalScope = 0.00;
        double dblTotalTimeline = 0.00;
        double dblTotalBudget = 0.00;
        foreach (RepeaterItem ri in rptStatus.Items)
        {
            Label _scope = (Label)ri.FindControl("lblScope");
            Label _timeline = (Label)ri.FindControl("lblTimeline");
            Label _budget = (Label)ri.FindControl("lblBudget");
            Label _status = (Label)ri.FindControl("lblStatus");
            Label _status_scope = (Label)ri.FindControl("lblStatusScope");
            Label _status_timeline = (Label)ri.FindControl("lblStatusTimeline");
            Label _status_budget = (Label)ri.FindControl("lblStatusBudget");
            double dblScope = double.Parse(_scope.Text);
            double dblTimeline = double.Parse(_timeline.Text);
            double dblBudget = double.Parse(_budget.Text);
            _status_scope.Text = oResourceRequest.GetStatus(dblScope, 60, 10);
            _status_timeline.Text = oResourceRequest.GetStatus(dblTimeline, 60, 10);
            _status_budget.Text = oResourceRequest.GetStatus(dblBudget, 60, 10);
            _status.Text = oResourceRequest.GetStatus(dblScope, dblTimeline, dblBudget, 83, 15);
            dblTotalScope = dblScope;
            dblTotalTimeline = dblTimeline;
            dblTotalBudget = dblBudget;
        }
        lblStatus.Text = oResourceRequest.GetStatus(dblTotalScope, dblTotalTimeline, dblTotalBudget, 83, 15);
    }
    private void LoadCSRC()
    {
        DataSet dsNew = oTPM.GetCSRCs(intRequest, intItem, intNumber);
        int intCount = 0;
        foreach (DataRow dr in dsNew.Tables[0].Rows)
        {
            intCount++;
            string strStatus = "Pending";
            if (dr["status"].ToString() == "1")
                strStatus = "Approved";
            if (dr["status"].ToString() == "-1")
                strStatus = "Denied";
            strCSRC += "<tr><td><a href=\"javascript:void(0);\" onclick=\"ShowHideDiv2('divCSRC" + intCount.ToString() + "');\">" + DateTime.Parse(dr["modified"].ToString()).ToShortDateString() + "</a></td><td>" + strStatus + "</td><td>" + (dr["completed"].ToString() == "" ? "N / A" : DateTime.Parse(dr["completed"].ToString()).ToShortDateString()) + "</td><td><a href=\"" + oVariable.URL() + "/" + dr["path"].ToString().Replace("\\", "/") + "\" target=\"_blank\">View CSRC Document</a></td></tr>";
            DataSet dsNew2 = oTPM.GetCSRCDetail(Int32.Parse(dr["id"].ToString()));
            string strTemp2 = "";
            foreach (DataRow dr2 in dsNew2.Tables[0].Rows)
            {
                string strRole = "Additional";
                if (dr2["step"].ToString() == "1")
                    strRole = "Team Lead";
                if (dr2["step"].ToString() == "2")
                    strRole = "Working Sponsor";
                if (dr2["step"].ToString() == "3")
                    strRole = "Executive Sponsor";
                strStatus = "Pending";
                if (dr2["status"].ToString() == "1")
                    strStatus = "Approved";
                if (dr2["status"].ToString() == "-1")
                    strStatus = "Denied";
                strTemp2 += "<tr><td nowrap valign=\"top\">" + oUser.GetFullName(Int32.Parse(dr2["userid"].ToString())) + "</td><td nowrap valign=\"top\">" + strRole + "</td><td nowrap valign=\"top\">" + strStatus + "</td><td valign=\"top\">" + (dr2["comments"].ToString() == "" ? "---" : dr2["comments"].ToString()) + "</td></tr>";
            }
            if (strTemp2 != "")
            {
                strTemp2 = "<tr><td><b>Approver</b></td><td><b>Role</b></td><td><b>Status</b></td><td><b>Comments</b></td></tr>" + strTemp2;
                strTemp2 = "<table width=\"100%\" cellpadding=\"4\" cellspacing=\"0\" border=\"0\" style=\"border:dashed 1px #CCCCCC\" class=\"lightdefault\">" + strTemp2 + "</table>";
            }
            strCSRC += "<tr><td colspan=\"4\"><div id=\"divCSRC" + intCount.ToString() + "\" style=\"display:none\">" + strTemp2 + "</div></td></tr>";
        }
        if (strCSRC == "")
            strCSRC = "<tr><td colspan=\"4\">&nbsp;<img src='/images/alert.gif' border='0' align='absmiddle'> No CSRC Documents</td></tr>";        
    }
    private void LoadPCR()
    {
        DataSet dsNew = oTPM.GetPCRs(intRequest, intItem, intNumber);
        int intCount = 0;
        foreach (DataRow dr in dsNew.Tables[0].Rows)
        {
            intCount++;
            string strStatus = "Pending";
            if (dr["status"].ToString() == "1")
                strStatus = "Approved";
            if (dr["status"].ToString() == "-1")
                strStatus = "Denied";
            strPCR += "<tr><td><a href=\"javascript:void(0);\" onclick=\"ShowHideDiv2('divPCR" + intCount.ToString() + "');\">" + DateTime.Parse(dr["modified"].ToString()).ToShortDateString() + "</a></td><td>" + strStatus + "</td><td>" + (dr["completed"].ToString() == "" ? "N / A" : DateTime.Parse(dr["completed"].ToString()).ToShortDateString()) + "</td><td align=\"center\">" + (dr["scope"].ToString() == "0" ? "No" : "Yes") + "</td><td align=\"center\">" + (dr["s"].ToString() == "0" ? "No" : "Yes") + "</td><td align=\"center\">" + (dr["f"].ToString() == "0" ? "No" : "Yes") + "</td><td><a href=\"" + oVariable.URL() + "/" + dr["path"].ToString().Replace("\\", "/") + "\" target=\"_blank\">View PCR Document</a></td></tr>";
            DataSet dsNew2 = oTPM.GetPCRDetail(Int32.Parse(dr["id"].ToString()));
            string strTemp2 = "";
            foreach (DataRow dr2 in dsNew2.Tables[0].Rows)
            {
                string strRole = "Additional";
                if (dr2["step"].ToString() == "1")
                    strRole = "Team Lead";
                if (dr2["step"].ToString() == "2")
                    strRole = "Working Sponsor";
                if (dr2["step"].ToString() == "3")
                    strRole = "Executive Sponsor";
                strStatus = "Pending";
                if (dr2["status"].ToString() == "1")
                    strStatus = "Approved";
                if (dr2["status"].ToString() == "-1")
                    strStatus = "Denied";
                strTemp2 += "<tr><td nowrap valign=\"top\">" + oUser.GetFullName(Int32.Parse(dr2["userid"].ToString())) + "</td><td nowrap valign=\"top\">" + strRole + "</td><td nowrap valign=\"top\">" + strStatus + "</td><td valign=\"top\">" + (dr2["comments"].ToString() == "" ? "---" : dr2["comments"].ToString()) + "</td></tr>";
            }
            if (strTemp2 != "")
            {
                strTemp2 = "<tr><td><b>Approver</b></td><td><b>Role</b></td><td><b>Status</b></td><td><b>Comments</b></td></tr>" + strTemp2;
                strTemp2 = "<table width=\"100%\" cellpadding=\"4\" cellspacing=\"0\" border=\"0\" style=\"border:dashed 1px #CCCCCC\" class=\"lightdefault\">" + strTemp2 + "</table>";
            }
            strPCR += "<tr><td colspan=\"7\"><div id=\"divPCR" + intCount.ToString() + "\" style=\"display:none\">" + strTemp2 + "</div></td></tr>";
        }
        if (strPCR == "")
            strPCR = "<tr><td colspan=\"7\">&nbsp;<img src='/images/alert.gif' border='0' align='absmiddle'> No PCR Documents</td></tr>";
    }
    private void LoadProject(int _request)
    {
        Organizations oOrganization = new Organizations(intProfile, dsn);
        DataSet dsProject = oProject.Get(intProject);
        lblName.Text = oProject.Get(intProject, "name");
        txtProjectName1.Text = lblName.Text;
        txtProjectName2.Text = lblName.Text;
        lblNumber.Text = oProject.Get(intProject, "number");
        txtProjectNumber.Text = lblNumber.Text;
        int intPortfolio = Int32.Parse(oProject.Get(intProject, "organization"));
        lblPortfolio.Text = oOrganization.GetName(intPortfolio);
        ddlPortfolio.SelectedValue = intPortfolio.ToString();
        lblSubmittedBy.Text = oUser.GetFullName(oRequest.GetUser(intRequest));
        txtDescription.Text = oRequest.Get(intRequest, "description");
        lblStart.Text = DateTime.Parse(oRequest.Get(intRequest, "start_date")).ToLongDateString();
        lblEnd.Text = DateTime.Parse(oRequest.Get(intRequest, "end_date")).ToLongDateString();
        lblAssigned.Text = DateTime.Parse(oResourceRequest.Get(_request, "modified")).ToLongDateString();
        txtDescription.Attributes.Add("onkeydown", "return DescriptionDown(this);");
        txtDescription.Attributes.Add("onkeyup", "return DescriptionUp(this);");
        CV_FIELD_10156.Text = oRequestField.GetItemValue(_request, 10156);
        hypSharepoint.NavigateUrl = CV_FIELD_10156.Text;
        // Project Schedule
        CV_FIELD_10112.Text = oRequestField.GetItemValue(_request, 10112);
        lblApprovedStart.Text = (CV_FIELD_10112.Text == "" ? "---" : CV_FIELD_10112.Text);
        CV_FIELD_10113.Text = oRequestField.GetItemValue(_request, 10113);
        CV_FIELD_10114.Text = oRequestField.GetItemValue(_request, 10114);
        CV_FIELD_10115.Text = oRequestField.GetItemValue(_request, 10115);
        CV_FIELD_10116.Text = oRequestField.GetItemValue(_request, 10116);
        CV_FIELD_10117.Text = oRequestField.GetItemValue(_request, 10117);
        CV_FIELD_10118.Text = oRequestField.GetItemValue(_request, 10118);
        CV_FIELD_10119.Text =  oRequestField.GetItemValue(_request, 10119);
        lblApprovedEnd.Text = (CV_FIELD_10119.Text == "" ? "---" : CV_FIELD_10119.Text);
        CV_FIELD_10044.Text = oRequestField.GetItemValue(_request, 10044);
        lblProjectStart.Text = (CV_FIELD_10044.Text == "" ? "---" : CV_FIELD_10044.Text);
        CV_FIELD_10045.Text = oRequestField.GetItemValue(_request, 10045);
        CV_FIELD_10046.Text = oRequestField.GetItemValue(_request, 10046);
        CV_FIELD_10047.Text = oRequestField.GetItemValue(_request, 10047);
        CV_FIELD_10048.Text = oRequestField.GetItemValue(_request, 10048);
        CV_FIELD_10049.Text = oRequestField.GetItemValue(_request, 10049);
        CV_FIELD_10050.Text = oRequestField.GetItemValue(_request, 10050);
        CV_FIELD_10051.Text = oRequestField.GetItemValue(_request, 10051);
        lblProjectEnd.Text = (CV_FIELD_10051.Text == "" ? "---" : CV_FIELD_10051.Text);
        if (CV_FIELD_10113.Text == "" || CV_FIELD_10045.Text == "")
            lblVarianceDaysD.Text = "---";
        else
        {
            TimeSpan oSpan = DateTime.Parse(CV_FIELD_10045.Text).Subtract(DateTime.Parse(CV_FIELD_10113.Text));
            lblVarianceDaysD.Text = oSpan.Days.ToString();
        }
        if (CV_FIELD_10112.Text == "" || CV_FIELD_10113.Text == "" || CV_FIELD_10045.Text == "")
            lblVariancePercentD.Text = "---";
        else
        {
            TimeSpan oSpan1 = DateTime.Parse(CV_FIELD_10045.Text).Subtract(DateTime.Parse(CV_FIELD_10112.Text));
            TimeSpan oSpan2 = DateTime.Parse(CV_FIELD_10113.Text).Subtract(DateTime.Parse(CV_FIELD_10112.Text));
            double dblSpan = (double.Parse(oSpan1.Days.ToString()) / double.Parse(oSpan2.Days.ToString()) - 1.00) * 100;
            lblVariancePercentD.Text = dblSpan.ToString("F") + "%";
        }
        if (CV_FIELD_10115.Text == "" || CV_FIELD_10047.Text == "")
            lblVarianceDaysP.Text = "---";
        else
        {
            TimeSpan oSpan = DateTime.Parse(CV_FIELD_10047.Text).Subtract(DateTime.Parse(CV_FIELD_10115.Text));
            lblVarianceDaysP.Text = oSpan.Days.ToString();
        }
        if (CV_FIELD_10114.Text == "" || CV_FIELD_10115.Text == "" || CV_FIELD_10047.Text == "")
            lblVariancePercentP.Text = "---";
        else
        {
            TimeSpan oSpan1 = DateTime.Parse(CV_FIELD_10047.Text).Subtract(DateTime.Parse(CV_FIELD_10114.Text));
            TimeSpan oSpan2 = DateTime.Parse(CV_FIELD_10115.Text).Subtract(DateTime.Parse(CV_FIELD_10114.Text));
            double dblSpan = (double.Parse(oSpan1.Days.ToString()) / double.Parse(oSpan2.Days.ToString()) - 1.00) * 100;
            lblVariancePercentP.Text = dblSpan.ToString("F") + "%";
        }
        if (CV_FIELD_10117.Text == "" || CV_FIELD_10049.Text == "")
            lblVarianceDaysE.Text = "---";
        else
        {
            TimeSpan oSpan = DateTime.Parse(CV_FIELD_10049.Text).Subtract(DateTime.Parse(CV_FIELD_10117.Text));
            lblVarianceDaysE.Text = oSpan.Days.ToString();
        }
        if (CV_FIELD_10116.Text == "" || CV_FIELD_10117.Text == "" || CV_FIELD_10049.Text == "")
            lblVariancePercentE.Text = "---";
        else
        {
            TimeSpan oSpan1 = DateTime.Parse(CV_FIELD_10049.Text).Subtract(DateTime.Parse(CV_FIELD_10116.Text));
            TimeSpan oSpan2 = DateTime.Parse(CV_FIELD_10117.Text).Subtract(DateTime.Parse(CV_FIELD_10116.Text));
            double dblSpan = (double.Parse(oSpan1.Days.ToString()) / double.Parse(oSpan2.Days.ToString()) - 1.00) * 100;
            lblVariancePercentE.Text = dblSpan.ToString("F") + "%";
        }
        if (CV_FIELD_10119.Text == "" || CV_FIELD_10051.Text == "")
            lblVarianceDaysC.Text = "---";
        else
        {
            TimeSpan oSpan = DateTime.Parse(CV_FIELD_10051.Text).Subtract(DateTime.Parse(CV_FIELD_10119.Text));
            lblVarianceDaysC.Text = oSpan.Days.ToString();
        }
        if (CV_FIELD_10118.Text == "" || CV_FIELD_10119.Text == "" || CV_FIELD_10051.Text == "")
            lblVariancePercentC.Text = "---";
        else
        {
            TimeSpan oSpan1 = DateTime.Parse(CV_FIELD_10051.Text).Subtract(DateTime.Parse(CV_FIELD_10118.Text));
            TimeSpan oSpan2 = DateTime.Parse(CV_FIELD_10119.Text).Subtract(DateTime.Parse(CV_FIELD_10118.Text));
            double dblSpan = (double.Parse(oSpan1.Days.ToString()) / double.Parse(oSpan2.Days.ToString()) - 1.00) * 100;
            lblVariancePercentC.Text = dblSpan.ToString("F") + "%";
        }
        if (lblProjectEnd.Text == "---" || lblApprovedEnd.Text == "---")
            lblVarianceDays.Text = "---";
        else
        {
            TimeSpan oSpan = DateTime.Parse(lblProjectEnd.Text).Subtract(DateTime.Parse(lblApprovedEnd.Text));
            lblVarianceDays.Text = oSpan.Days.ToString();
        }
        if (lblApprovedStart.Text == "---" || lblProjectEnd.Text == "---" || lblApprovedEnd.Text == "---")
            lblVariancePercent.Text = "---";
        else
        {
            TimeSpan oSpan1 = DateTime.Parse(lblApprovedEnd.Text).Subtract(DateTime.Parse(lblApprovedStart.Text));
            TimeSpan oSpan2 = DateTime.Parse(lblProjectEnd.Text).Subtract(DateTime.Parse(lblApprovedStart.Text));
            double dblSpan = (double.Parse(oSpan1.Days.ToString()) / double.Parse(oSpan2.Days.ToString()) - 1.00) * 100;
            lblVariancePercent.Text = dblSpan.ToString("F") + "%";
        }
        if (CV_FIELD_10044.Text == "" || CV_FIELD_10045.Text == "")
        {
            chkPCRScheduleD.Enabled = false;
            lblPCRScheduleD.Text = "N / A";
        }
        else
            lblPCRScheduleD.Text = CV_FIELD_10044.Text + " - " + CV_FIELD_10045.Text;
        if (CV_FIELD_10046.Text == "" || CV_FIELD_10047.Text == "")
        {
            chkPCRScheduleP.Enabled = false;
            lblPCRScheduleP.Text = "N / A";
        }
        else
            lblPCRScheduleP.Text = CV_FIELD_10046.Text + " - " + CV_FIELD_10047.Text;
        if (CV_FIELD_10048.Text == "" || CV_FIELD_10049.Text == "")
        {
            chkPCRScheduleE.Enabled = false;
            lblPCRScheduleE.Text = "N / A";
        }
        else
            lblPCRScheduleE.Text = CV_FIELD_10048.Text + " - " + CV_FIELD_10049.Text;
        if (CV_FIELD_10050.Text == "" || CV_FIELD_10051.Text == "")
        {
            chkPCRScheduleC.Enabled = false;
            lblPCRScheduleC.Text = "N / A";
        }
        else
            lblPCRScheduleC.Text = CV_FIELD_10050.Text + " - " + CV_FIELD_10051.Text;
        
        // ****************************************************
        // ***************** Project Financials ***************
        // ****************************************************
        // ..... DISCOVERY .....
        double dblAppDI = 0.00;
        if (oRequestField.GetItemValue(_request, 10120) != "")
            dblAppDI = double.Parse(oRequestField.GetItemValue(_request, 10120));
        dblAppDI = 2000.00;
        CV_FIELD_10120.Text = dblAppDI.ToString("F");
        double dblAppDE = 0.00;
        if (oRequestField.GetItemValue(_request, 10121) != "")
            dblAppDE = double.Parse(oRequestField.GetItemValue(_request, 10121));
        CV_FIELD_10121.Text = dblAppDE.ToString("F");
        double dblAppDH = 0.00;
        if (oRequestField.GetItemValue(_request, 10122) != "")
            dblAppDH = double.Parse(oRequestField.GetItemValue(_request, 10122));
        CV_FIELD_10122.Text = dblAppDH.ToString("F");
        double dblActDI = 0.00;
        if (oRequestField.GetItemValue(_request, 10123) != "")
            dblActDI = double.Parse(oRequestField.GetItemValue(_request, 10123));
        CV_FIELD_10123.Text = dblActDI.ToString("F");
        double dblActDE = 0.00;
        if (oRequestField.GetItemValue(_request, 10124) != "")
            dblActDE = double.Parse(oRequestField.GetItemValue(_request, 10124));
        CV_FIELD_10124.Text = dblActDE.ToString("F");
        double dblActDH = 0.00;
        if (oRequestField.GetItemValue(_request, 10125) != "")
            dblActDH = double.Parse(oRequestField.GetItemValue(_request, 10125));
        CV_FIELD_10125.Text = dblActDH.ToString("F");
        double dblEstDI = 0.00;
        if (oRequestField.GetItemValue(_request, 10126) != "")
            dblEstDI = double.Parse(oRequestField.GetItemValue(_request, 10126));
        CV_FIELD_10126.Text = dblEstDI.ToString("F");
        double dblEstDE = 0.00;
        if (oRequestField.GetItemValue(_request, 10127) != "")
            dblEstDE = double.Parse(oRequestField.GetItemValue(_request, 10127));
        CV_FIELD_10127.Text = dblEstDE.ToString("F");
        double dblEstDH = 0.00;
        if (oRequestField.GetItemValue(_request, 10128) != "")
            dblEstDH = double.Parse(oRequestField.GetItemValue(_request, 10128));
        CV_FIELD_10128.Text = dblEstDH.ToString("F");
        double dblForeDI = dblActDI + dblEstDI;
        lblForeDI.Text = dblForeDI.ToString("N");
        double dblForeDE = dblActDE + dblEstDE;
        lblForeDE.Text = dblForeDE.ToString("N");
        double dblForeDH = dblActDH + dblEstDH;
        lblForeDH.Text = dblForeDH.ToString("N");
        double dblVarDDI = dblForeDI - dblAppDI;
        lblVarDDI.Text = dblVarDDI.ToString("N");
        double dblVarDDE = dblForeDE - dblAppDE;
        lblVarDDE.Text = dblVarDDE.ToString("N");
        double dblVarDDH = dblForeDH - dblAppDH;
        lblVarDDH.Text = dblVarDDH.ToString("N");
        double dblVarPDI = dblVarDDI * 100 / dblAppDI;
        lblVarPDI.Text = dblVarPDI.ToString("F") + "%";
        double dblVarPDE = dblVarDDE * 100 / dblAppDE;
        lblVarPDE.Text = dblVarPDE.ToString("F") + "%";
        double dblVarPDH = dblVarDDH * 100 / dblAppDH;
        lblVarPDH.Text = dblVarPDH.ToString("F") + "%";
        double dblAppD = dblAppDI + dblAppDE + dblAppDH;
        lblAppD.Text = dblAppD.ToString("N");
        double dblActD = dblActDI + dblActDE + dblActDH;
        lblActD.Text = dblActD.ToString("N");
        double dblEstD = dblEstDI + dblEstDE + dblEstDH;
        lblEstimateD.Text = dblEstD.ToString("N");
        double dblForeD = dblForeDI + dblForeDE + dblForeDH;
        lblForeD.Text = dblForeD.ToString("N");
        double dblVarDD = dblVarDDI + dblVarDDE + dblVarDDH;
        lblVarDD.Text = dblVarDD.ToString("N");
        double dblVarPD = dblVarDD * 100 / dblAppD;
        lblVarPD.Text = dblVarPD.ToString("F") + "%";
        // ..... PLANNING .....
        double dblAppPI = 0.00;
        if (oRequestField.GetItemValue(_request, 10129) != "")
            dblAppPI = double.Parse(oRequestField.GetItemValue(_request, 10129));
        CV_FIELD_10129.Text = dblAppPI.ToString("F");
        double dblAppPE = 0.00;
        if (oRequestField.GetItemValue(_request, 10130) != "")
            dblAppPE = double.Parse(oRequestField.GetItemValue(_request, 10130));
        CV_FIELD_10130.Text = dblAppPE.ToString("F");
        double dblAppPH = 0.00;
        if (oRequestField.GetItemValue(_request, 10131) != "")
            dblAppPH = double.Parse(oRequestField.GetItemValue(_request, 10131));
        CV_FIELD_10131.Text = dblAppPH.ToString("F");
        double dblActPI = 0.00;
        if (oRequestField.GetItemValue(_request, 10132) != "")
            dblActPI = double.Parse(oRequestField.GetItemValue(_request, 10132));
        CV_FIELD_10132.Text = dblActPI.ToString("F");
        double dblActPE = 0.00;
        if (oRequestField.GetItemValue(_request, 10133) != "")
            dblActPE = double.Parse(oRequestField.GetItemValue(_request, 10133));
        CV_FIELD_10133.Text = dblActPE.ToString("F");
        double dblActPH = 0.00;
        if (oRequestField.GetItemValue(_request, 10134) != "")
            dblActPH = double.Parse(oRequestField.GetItemValue(_request, 10134));
        CV_FIELD_10134.Text = dblActPH.ToString("F");
        double dblEstPI = 0.00;
        if (oRequestField.GetItemValue(_request, 10135) != "")
            dblEstPI = double.Parse(oRequestField.GetItemValue(_request, 10135));
        CV_FIELD_10135.Text = dblEstPI.ToString("F");
        double dblEstPE = 0.00;
        if (oRequestField.GetItemValue(_request, 10136) != "")
            dblEstPE = double.Parse(oRequestField.GetItemValue(_request, 10136));
        CV_FIELD_10136.Text = dblEstPE.ToString("F");
        double dblEstPH = 0.00;
        if (oRequestField.GetItemValue(_request, 10137) != "")
            dblEstPH = double.Parse(oRequestField.GetItemValue(_request, 10137));
        CV_FIELD_10137.Text = dblEstPH.ToString("F");
        double dblForePI = dblActPI + dblEstPI;
        lblForePI.Text = dblForePI.ToString("N");
        double dblForePE = dblActPE + dblEstPE;
        lblForePE.Text = dblForePE.ToString("N");
        double dblForePH = dblActPH + dblEstPH;
        lblForePH.Text = dblForePH.ToString("N");
        double dblVarDPI = dblForePI - dblAppPI;
        lblVarDPI.Text = dblVarDPI.ToString("N");
        double dblVarDPE = dblForePE - dblAppPE;
        lblVarDPE.Text = dblVarDPE.ToString("N");
        double dblVarDPH = dblForePH - dblAppPH;
        lblVarDPH.Text = dblVarDPH.ToString("N");
        double dblVarPPI = dblVarDPI * 100 / dblAppPI;
        lblVarPPI.Text = dblVarPPI.ToString("F") + "%";
        double dblVarPPE = dblVarDPE * 100 / dblAppPE;
        lblVarPPE.Text = dblVarPPE.ToString("F") + "%";
        double dblVarPPH = dblVarDPH * 100 / dblAppPH;
        lblVarPPH.Text = dblVarPPH.ToString("F") + "%";
        double dblAppP = dblAppPI + dblAppPE + dblAppPH;
        lblAppP.Text = dblAppP.ToString("N");
        double dblActP = dblActPI + dblActPE + dblActPH;
        lblActP.Text = dblActP.ToString("N");
        double dblEstP = dblEstPI + dblEstPE + dblEstPH;
        lblEstimateP.Text = dblEstP.ToString("N");
        double dblForeP = dblForePI + dblForePE + dblForePH;
        lblForeP.Text = dblForeP.ToString("N");
        double dblVarDP = dblVarDPI + dblVarDPE + dblVarDPH;
        lblVarDP.Text = dblVarDP.ToString("N");
        double dblVarPP = dblVarDP * 100 / dblAppP;
        lblVarPP.Text = dblVarPP.ToString("F") + "%";
        // ..... EXECUTION  .....
        double dblAppEI = 0.00;
        if (oRequestField.GetItemValue(_request, 10138) != "")
            dblAppEI = double.Parse(oRequestField.GetItemValue(_request, 10138));
        CV_FIELD_10138.Text = dblAppEI.ToString("F");
        double dblAppEE = 0.00;
        if (oRequestField.GetItemValue(_request, 10139) != "")
            dblAppEE = double.Parse(oRequestField.GetItemValue(_request, 10139));
        CV_FIELD_10139.Text = dblAppEE.ToString("F");
        double dblAppEH = 0.00;
        if (oRequestField.GetItemValue(_request, 10140) != "")
            dblAppEH = double.Parse(oRequestField.GetItemValue(_request, 10140));
        CV_FIELD_10140.Text = dblAppEH.ToString("F");
        double dblActEI = 0.00;
        if (oRequestField.GetItemValue(_request, 10141) != "")
            dblActEI = double.Parse(oRequestField.GetItemValue(_request, 10141));
        CV_FIELD_10141.Text = dblActEI.ToString("F");
        double dblActEE = 0.00;
        if (oRequestField.GetItemValue(_request, 10142) != "")
            dblActEE = double.Parse(oRequestField.GetItemValue(_request, 10142));
        CV_FIELD_10142.Text = dblActEE.ToString("F");
        double dblActEH = 0.00;
        if (oRequestField.GetItemValue(_request, 10143) != "")
            dblActEH = double.Parse(oRequestField.GetItemValue(_request, 10143));
        CV_FIELD_10143.Text = dblActEH.ToString("F");
        double dblEstEI = 0.00;
        if (oRequestField.GetItemValue(_request, 10144) != "")
            dblEstEI = double.Parse(oRequestField.GetItemValue(_request, 10144));
        CV_FIELD_10144.Text = dblEstEI.ToString("F");
        double dblEstEE = 0.00;
        if (oRequestField.GetItemValue(_request, 10145) != "")
            dblEstEE = double.Parse(oRequestField.GetItemValue(_request, 10145));
        CV_FIELD_10145.Text = dblEstEE.ToString("F");
        double dblEstEH = 0.00;
        if (oRequestField.GetItemValue(_request, 10146) != "")
            dblEstEH = double.Parse(oRequestField.GetItemValue(_request, 10146));
        CV_FIELD_10146.Text = dblEstEH.ToString("F");
        double dblForeEI = dblActEI + dblEstEI;
        lblForeEI.Text = dblForeEI.ToString("N");
        double dblForeEE = dblActEE + dblEstEE;
        lblForeEE.Text = dblForeEE.ToString("N");
        double dblForeEH = dblActEH + dblEstEH;
        lblForeEH.Text = dblForeEH.ToString("N");
        double dblVarDEI = dblForeEI - dblAppEI;
        lblVarDEI.Text = dblVarDEI.ToString("N");
        double dblVarDEE = dblForeEE - dblAppEE;
        lblVarDEE.Text = dblVarDEE.ToString("N");
        double dblVarDEH = dblForeEH - dblAppEH;
        lblVarDEH.Text = dblVarDEH.ToString("N");
        double dblVarPEI = dblVarDEI * 100 / dblAppEI;
        lblVarPEI.Text = dblVarPEI.ToString("F") + "%";
        double dblVarPEE = dblVarDEE * 100 / dblAppEE;
        lblVarPEE.Text = dblVarPEE.ToString("F") + "%";
        double dblVarPEH = dblVarDEH * 100 / dblAppEH;
        lblVarPEH.Text = dblVarPEH.ToString("F") + "%";
        double dblAppE = dblAppEI + dblAppEE + dblAppEH;
        lblAppE.Text = dblAppE.ToString("N");
        double dblActE = dblActEI + dblActEE + dblActEH;
        lblActE.Text = dblActE.ToString("N");
        double dblEstE = dblEstEI + dblEstEE + dblEstEH;
        lblEstimateE.Text = dblEstE.ToString("N");
        double dblForeE = dblForeEI + dblForeEE + dblForeEH;
        lblForeE.Text = dblForeE.ToString("N");
        double dblVarDE = dblVarDEI + dblVarDEE + dblVarDEH;
        lblVarDE.Text = dblVarDE.ToString("N");
        double dblVarPE = dblVarDE * 100 / dblAppE;
        lblVarPE.Text = dblVarPE.ToString("F") + "%";
        // ..... CLOSING  .....
        double dblAppCI = 0.00;
        if (oRequestField.GetItemValue(_request, 10147) != "")
            dblAppCI = double.Parse(oRequestField.GetItemValue(_request, 10147));
        CV_FIELD_10147.Text = dblAppCI.ToString("F");
        double dblAppCE = 0.00;
        if (oRequestField.GetItemValue(_request, 10148) != "")
            dblAppCE = double.Parse(oRequestField.GetItemValue(_request, 10148));
        CV_FIELD_10148.Text = dblAppCE.ToString("F");
        double dblAppCH = 0.00;
        if (oRequestField.GetItemValue(_request, 10149) != "")
            dblAppCH = double.Parse(oRequestField.GetItemValue(_request, 10149));
        CV_FIELD_10149.Text = dblAppCH.ToString("F");
        double dblActCI = 0.00;
        if (oRequestField.GetItemValue(_request, 10150) != "")
            dblActCI = double.Parse(oRequestField.GetItemValue(_request, 10150));
        CV_FIELD_10150.Text = dblActCI.ToString("F");
        double dblActCE = 0.00;
        if (oRequestField.GetItemValue(_request, 10151) != "")
            dblActCE = double.Parse(oRequestField.GetItemValue(_request, 10151));
        CV_FIELD_10151.Text = dblActCE.ToString("F");
        double dblActCH = 0.00;
        if (oRequestField.GetItemValue(_request, 10152) != "")
            dblActCH = double.Parse(oRequestField.GetItemValue(_request, 10152));
        CV_FIELD_10152.Text = dblActCH.ToString("F");
        double dblEstCI = 0.00;
        if (oRequestField.GetItemValue(_request, 10153) != "")
            dblEstCI = double.Parse(oRequestField.GetItemValue(_request, 10153));
        CV_FIELD_10153.Text = dblEstCI.ToString("F");
        double dblEstCE = 0.00;
        if (oRequestField.GetItemValue(_request, 10154) != "")
            dblEstCE = double.Parse(oRequestField.GetItemValue(_request, 10154));
        CV_FIELD_10154.Text = dblEstCE.ToString("F");
        double dblEstCH = 0.00;
        if (oRequestField.GetItemValue(_request, 10155) != "")
            dblEstCH = double.Parse(oRequestField.GetItemValue(_request, 10155));
        CV_FIELD_10155.Text = dblEstCH.ToString("F");
        double dblForeCI = dblActCI + dblEstCI;
        lblForeCI.Text = dblForeCI.ToString("N");
        double dblForeCE = dblActCE + dblEstCE;
        lblForeCE.Text = dblForeCE.ToString("N");
        double dblForeCH = dblActCH + dblEstCH;
        lblForeCH.Text = dblForeCH.ToString("N");
        double dblVarDCI = dblForeCI - dblAppCI;
        lblVarDCI.Text = dblVarDCI.ToString("N");
        double dblVarDCE = dblForeCE - dblAppCE;
        lblVarDCE.Text = dblVarDCE.ToString("N");
        double dblVarDCH = dblForeCH - dblAppCH;
        lblVarDCH.Text = dblVarDCH.ToString("N");
        double dblVarPCI = dblVarDCI * 100 / dblAppCI;
        lblVarPCI.Text = dblVarPCI.ToString("F") + "%";
        double dblVarPCE = dblVarDCE * 100 / dblAppCE;
        lblVarPCE.Text = dblVarPCE.ToString("F") + "%";
        double dblVarPCH = dblVarDCH * 100 / dblAppCH;
        lblVarPCH.Text = dblVarPCH.ToString("F") + "%";
        double dblAppC = dblAppCI + dblAppCE + dblAppCH;
        lblAppC.Text = dblAppC.ToString("N");
        double dblActC = dblActCI + dblActCE + dblActCH;
        lblActC.Text = dblActC.ToString("N");
        double dblEstC = dblEstCI + dblEstCE + dblEstCH;
        lblEstimateC.Text = dblEstC.ToString("N");
        double dblForeC = dblForeCI + dblForeCE + dblForeCH;
        lblForeC.Text = dblForeC.ToString("N");
        double dblVarDC = dblVarDCI + dblVarDCE + dblVarDCH;
        lblVarDC.Text = dblVarDC.ToString("N");
        double dblVarPC = dblVarDC * 100 / dblAppC;
        lblVarPC.Text = dblVarPC.ToString("F") + "%";
        // Totals
        double dblApp = dblAppD + dblAppP + dblAppE + dblAppC;
        lblApp.Text = dblApp.ToString("N");
        double dblAct = dblActD + dblActP + dblActE + dblActC;
        lblAct.Text = dblAct.ToString("N");
        double dblEst = dblEstD + dblEstP + dblEstE + dblEstC;
        lblEstimate.Text = dblEst.ToString("N");
        double dblFore = dblForeD + dblForeP + dblForeE + dblForeC;
        lblFore.Text = dblFore.ToString("N");
        double dblVarD = dblVarDD + dblVarDP + dblVarDE + dblVarDC;
        lblVarD.Text = dblVarD.ToString("N");
        double dblVarP = dblVarD * 100 / dblApp;
        lblVarP.Text = dblVarP.ToString("F") + "%";

        lblPCRFinancialD.Text = "$" + dblAppD.ToString("N");
        lblPCRFinancialP.Text = "$" + dblAppP.ToString("N");
        lblPCRFinancialE.Text = "$" + dblAppE.ToString("N");
        lblPCRFinancialC.Text = "$" + dblAppC.ToString("N");

        ddlStatus.SelectedValue = oProject.Get(intProject, "status"); ;
        CV_FIELD_10111.SelectedValue = oRequestField.GetItemValue(_request, 10111);
        
        double dblApprovedI = dblAppDI + dblAppPI + dblAppEI + dblAppCI;
        double dblApprovedE = dblAppDE + dblAppPE + dblAppEE + dblAppCE;
        double dblApprovedC = dblAppDH + dblAppPH + dblAppEH + dblAppCH;
        double dblActualI = dblActDI + dblActPI + dblActEI + dblActCI;
        double dblActualE = dblActDE + dblActPE + dblActEE + dblActCE;
        double dblActualC = dblActDH + dblActPH + dblActEH + dblActCH;
        txtStatusDate.Text = DateTime.Now.ToShortDateString();
        string strCosts = oRequestField.GetItemValue(_request, 10059);
        CV_FIELD_10059.Value = strCosts;
        string[] strCost;
        char[] strSplit = { '&' };
        strCost = strCosts.Split(strSplit);
        for (int ii = 0; ii < lstCostsAvailable.Items.Count; ii++)
        {
            for (int jj = 0; jj < strCost.Length; jj++)
            {
                if (strCost[jj].Trim() != "" && strCost[jj] == lstCostsAvailable.Items[ii].Value)
                {
                    lstCostsCurrent.Items.Add(lstCostsAvailable.Items[ii]);
                    lstCostsAvailable.Items.Remove(lstCostsAvailable.Items[ii]);
                    ii--;
                    break;
                }
            }
        }
        CV_FIELD_10043.Text = oRequestField.GetItemValue(_request, 10043);
        CV_FIELD_10088.Text = oRequestField.GetItemValue(_request, 10088);
        CV_FIELD_10089.Text = oRequestField.GetItemValue(_request, 10089);
        CV_FIELD_10090.Text = oRequestField.GetItemValue(_request, 10090);
        lblApprovedI.Text = dblApprovedI.ToString("N");
        lblApprovedE.Text = dblApprovedE.ToString("N");
        lblApprovedC.Text = dblApprovedC.ToString("N");
        double dblApproved = dblApprovedC + dblApprovedE + dblApprovedI;
        lblApproved.Text = dblApproved.ToString("N");
        lblActualI.Text = dblActualI.ToString("N");
        lblActualE.Text = dblActualE.ToString("N");
        lblActualC.Text = dblActualC.ToString("N");
        double dblActual = dblActualI + dblActualE + dblActualC;
        lblActual.Text = dblActual.ToString("N");
        double dblVarianceI = dblApprovedI - dblActualI;
        double dblVarianceE = dblApprovedE - dblActualE;
        double dblVarianceC = dblApprovedC - dblActualC;
        lblVarianceI.Text = dblVarianceI.ToString("N");
        lblVarianceE.Text = dblVarianceE.ToString("N");
        lblVarianceC.Text = dblVarianceC.ToString("N");
        double dblVariance = dblVarianceI + dblVarianceE + dblVarianceC;
        lblVariance.Text = dblVariance.ToString("N");
        lblTotalApproved.Text = lblApproved.Text;
        lblTotalActual.Text = lblActual.Text;
        lblTotalVariance.Text = lblVariance.Text;
        lblApprovedS.Text = lblApprovedStart.Text;
        lblApprovedF.Text = lblApprovedEnd.Text;
        lblActualS.Text = lblProjectStart.Text;
        lblActualF.Text = lblProjectEnd.Text;
        if (lblApprovedS.Text != "---" && lblActualS.Text != "---") 
        {
            TimeSpan oSpan = DateTime.Parse(lblApprovedS.Text).Subtract(DateTime.Parse(lblApprovedStart.Text));
            lblVarianceS.Text = oSpan.Days.ToString();
        }
        else
            lblVarianceS.Text = "---";
        if (lblApprovedF.Text != "---" && lblActualF.Text != "---")
        {
            TimeSpan oSpan = DateTime.Parse(lblApprovedF.Text).Subtract(DateTime.Parse(lblApprovedEnd.Text));
            lblVarianceF.Text = oSpan.Days.ToString();
        }
        else
            lblVarianceF.Text = "---";
        if (lblEndDate.Text == "")
            lblEndDate.Text = "<i>Pending</i>";
        if (Request.QueryString["div"] != null)
        {
            switch (Request.QueryString["div"])
            {
                case "D":
                    boolDetails = true;
                    boolStatus = false;
                    boolInformation = false;
                    boolClose = false;
                    break;
                case "S":
                    boolDetails = false;
                    boolStatus = true;
                    boolInformation = false;
                    boolClose = false;
                    break;
                case "I":
                    boolDetails = false;
                    boolStatus = false;
                    boolInformation = true;
                    boolClose = false;
                    break;
                case "C":
                    boolDetails = false;
                    boolStatus = false;
                    boolInformation = false;
                    boolClose = true;
                    break;
            }
        }
        else
        {
            boolDetails = false;
            boolStatus = false;
            boolInformation = false;
            boolClose = false;
        }
        if (boolDetails == false && boolStatus == false && boolInformation == false && boolClose == false)
            boolDetails = true;
    }
    private void btnSave_Click(Object Sender, EventArgs e)
    {
        int intResource = Int32.Parse(lblRequest.Text);
        switch (Request.Form[hdnTab.UniqueID])
        {
            case "D":
                UpdateProject();
                oRequestField.AddFormFields(Request, intRequest, intItem, intNumber);
                Response.Redirect(Request.Path + "?rrid=" + lblRequest.Text + "&div=D&save=true");
                break;
            case "S":
                if (ddlScope.SelectedIndex > -1 && ddlTimeline.SelectedIndex > -1 && ddlBudget.SelectedIndex > -1 && txtStatusDate.Text != "" && txtComments.Text != "" && txtThisWeek.Text != "" && txtNextWeek.Text != "")
                    oResourceRequest.AddStatusTPM(intResource, Int32.Parse(ddlScope.SelectedItem.Value), Int32.Parse(ddlTimeline.SelectedItem.Value), Int32.Parse(ddlBudget.SelectedItem.Value), DateTime.Parse(txtStatusDate.Text), txtComments.Text, txtThisWeek.Text, txtNextWeek.Text);
                UpdateProject();
                oRequestField.AddItemValue(intRequest, intItem, 10111, CV_FIELD_10111.SelectedItem.Value, intNumber);
                oRequestField.AddFormFields(Request, intRequest, intItem, intNumber);
                Response.Redirect(Request.Path + "?rrid=" + lblRequest.Text + "&div=S&save=true");
                break;
            case "I":
                Response.Redirect(Request.Path + "?rrid=" + lblRequest.Text + "&div=S&save=true");
                break;
            case "C":
                CloseProject(false);
                Response.Redirect(Request.Path + "?rrid=" + lblRequest.Text + "&save=true&div=C");
                break;
        }
    }
    private void UpdateProject()
    {
        string strName = "";
        if (txtProjectName1.Text != lblName.Text)
            strName = txtProjectName1.Text;
        if (txtProjectName2.Text != lblName.Text)
            strName = txtProjectName2.Text;
        if (strName == "")
            strName = lblName.Text;
        if (strName != "")
        {
            string strBody = "";
            string strTo = "";
            if (strName != lblName.Text)
                strBody += "<li>The project name was changed<br/><br/></li>";
            int intPortfolio = Int32.Parse(oProject.Get(intProject, "organization"));
            int intNewPortfolio = Int32.Parse(ddlPortfolio.SelectedItem.Value);
            if (intPortfolio != intNewPortfolio)
                strBody += "<li>The sponsoring portfolio was changed<br/><br/></li>";
            int intStatus = Int32.Parse(oProject.Get(intProject, "status"));
            int intNewStatus = Int32.Parse(ddlStatus.SelectedItem.Value);
            if (intStatus != intNewStatus)
                strBody += "<li>The project status was changed to " + ddlStatus.SelectedItem.Text.ToUpper() + "<br/><br/></li>";
            int intUser = Int32.Parse(oProject.Get(intProject, "userid"));
            oProject.Update(intProject, strName, oProject.Get(intProject, "bd"), txtProjectNumber.Text, intUser, intNewPortfolio, intNewStatus);
            string strDescription = oRequest.Get(intRequest, "description");
            if (strDescription != txtDescription.Text) 
            {
                oRequest.UpdateDescription(intRequest, txtDescription.Text);
                strBody += "<li>The project description was changed<br/><br/></li>";
            }
            if (Request.Form[hdnWorking.UniqueID] != "")
            {
                int intNewWorking = Int32.Parse(Request.Form[hdnWorking.UniqueID]);
                if (intWorking != intNewWorking)
                {
                    strBody += "<li>The working sponsor was changed from " + oUser.GetFullName(intWorking) + " to " + oUser.GetFullName(intNewWorking) + "<br/><br/></li>";
                    strTo = oUser.GetName(intWorking) + ";" + oUser.GetName(intNewWorking) + ";";
                    intWorking = intNewWorking;
                }
                else
                    strTo = oUser.GetName(intWorking) + ";";
            }
            else
                strTo = oUser.GetName(intWorking) + ";";
            if (Request.Form[hdnExecutive.UniqueID] != "")
            {
                int intNewExecutive = Int32.Parse(Request.Form[hdnExecutive.UniqueID]);
                if (intExecutive != intNewExecutive)
                {
                    strBody += "<li>The executive sponsor was changed from " + oUser.GetFullName(intExecutive) + " to " + oUser.GetFullName(intNewExecutive) + "<br/><br/></li>";
                    strTo += oUser.GetName(intExecutive) + ";" + oUser.GetName(intNewExecutive) + ";";
                    intExecutive = intNewExecutive;
                }
                else
                    strTo += oUser.GetName(intExecutive) + ";";
            }
            else
                strTo += oUser.GetName(intExecutive) + ";";
            lblRequest.Text = Request.QueryString["rrid"];
            int intResource = Int32.Parse(lblRequest.Text);
            if (oResourceRequest.Get(intResource, "solo") == "0")
                oProjectRequest.Update(intRequest, intExecutive, intWorking);
            else
            {
                oRequestField.AddItemValue(intRequest, intItem, 10000, intWorking.ToString(), intNumber);
                oRequestField.AddItemValue(intRequest, intItem, 10038, intExecutive.ToString(), intNumber);
            }
            if (strBody != "")
                Notify(strTo, strBody, (intStatus != intNewStatus));
        }
    }
    private void btnComplete_Click(Object Sender, EventArgs e)
    {
        CloseProject(true);
        Response.Redirect(Request.Path + "?rrid=" + lblRequest.Text + "&action=finish");
    }
    private void CloseProject(bool _done)
    {
        int intResource = Int32.Parse(lblRequest.Text);
        oRequestField.AddFormFields(Request, intRequest, intItem, intNumber);
        if (_done == true)
        {
            oResourceRequest.UpdateStatus(intResource, 3);
            oResourceRequest.Close(intResource, intEnvironment, strBCC, 0);
            oRequest.Close(intRequest, intEnvironment, strBCC);
            Response.Redirect(Request.Path + "?action=finish");
        }
    }
    private void btnCSRC_Click(Object Sender, EventArgs e)
    {
        if (oCSRC.PostedFile != null && oCSRC.FileName != "")
        {
            DateTime datNow = DateTime.Now;
            string strDocument = datNow.Month.ToString() + datNow.Day.ToString() + datNow.Year.ToString() + datNow.Hour.ToString() + datNow.Minute.ToString() + datNow.Second.ToString();
            string strDirectory = "uploads\\projects\\" + intProject.ToString();
            if (Directory.Exists(Request.PhysicalApplicationPath + strDirectory) == false)
                Directory.CreateDirectory(Request.PhysicalApplicationPath + strDirectory);
            strDirectory += "\\csrc";
            if (Directory.Exists(Request.PhysicalApplicationPath + strDirectory) == false)
                Directory.CreateDirectory(Request.PhysicalApplicationPath + strDirectory);
            string strPath = strDirectory + "\\" + strDocument + oCSRC.FileName.Substring(oCSRC.FileName.LastIndexOf("."));
            oCSRC.PostedFile.SaveAs(Request.PhysicalApplicationPath + strPath);
            int intCC = 0;
            if (Request.Form[hdnCSRCC.UniqueID] != "")
                intCC = Int32.Parse(Request.Form[hdnCSRCC.UniqueID]);
            int intId = oTPM.AddCSRC(intRequest, intItem, intNumber, (chkDiscovery.Checked ? 1 : 0), (chkPlanning.Checked ? 1 : 0), (chkExecution.Checked ? 0 : 1), (chkClosing.Checked ? 0 : 1), strPath, txtCSRCSD.Text, txtCSRCED.Text, txtCSRCID.Text, txtCSRCExD.Text, txtCSRCHD.Text, txtCSRCSP.Text, txtCSRCEP.Text, txtCSRCIP.Text, txtCSRCExP.Text, txtCSRCHP.Text, txtCSRCSE.Text, txtCSRCEE.Text, txtCSRCIE.Text, txtCSRCExE.Text, txtCSRCHE.Text, txtCSRCSC.Text, txtCSRCEC.Text, txtCSRCIC.Text, txtCSRCExC.Text, txtCSRCHC.Text, intCC);
            // Run routing
            oTPM.AddCSRCDetail(intId, 1, intLead, 0);
            oTPM.AddCSRCDetail(intId, 2, intWorking, -10);
            oTPM.AddCSRCDetail(intId, 3, intExecutive, -10);
            if (Request.Form[hdnCSRCD.UniqueID] != "")
                oTPM.AddCSRCDetail(intId, 4, Int32.Parse(Request.Form[hdnCSRCD.UniqueID]), -10);
            oTPM.ApproveCSRC(intId, 1, 0, intCSRCPage, intWorkloadManager, strBCC);
            Response.Redirect(Request.Path + "?rrid=" + lblRequest.Text + "&div=I&save=true");
        }
        Response.Redirect(Request.Path + "?rrid=" + lblRequest.Text + "&div=I");
    }
    private void btnPCR_Click(Object Sender, EventArgs e)
    {
        if (oPCR.PostedFile != null && oPCR.FileName != "")
        {
            DateTime datNow = DateTime.Now;
            string strDocument = datNow.Month.ToString() + datNow.Day.ToString() + datNow.Year.ToString() + datNow.Hour.ToString() + datNow.Minute.ToString() + datNow.Second.ToString();
            string strDirectory = "uploads\\projects\\" + intProject.ToString();
            if (Directory.Exists(Request.PhysicalApplicationPath + strDirectory) == false)
                Directory.CreateDirectory(Request.PhysicalApplicationPath + strDirectory);
            strDirectory += "\\pcr";
            if (Directory.Exists(Request.PhysicalApplicationPath + strDirectory) == false)
                Directory.CreateDirectory(Request.PhysicalApplicationPath + strDirectory);
            string strPath = strDirectory + "\\" + strDocument + oPCR.FileName.Substring(oPCR.FileName.LastIndexOf("."));
            oCSRC.PostedFile.SaveAs(Request.PhysicalApplicationPath + strPath);
            string strReason = "";
            for (int ii = 0; ii < chkPCRReason.Items.Count; ii++)
            {
                if (chkPCRReason.Items[ii].Selected == true)
                    strReason += chkPCRReason.Items[ii].Value + ";";
            }
            int intCC = 0;
            if (Request.Form[hdnPCRC.UniqueID] != "")
                intCC = Int32.Parse(Request.Form[hdnPCRC.UniqueID]);
            int intId = oTPM.AddPCR(intRequest, intItem, intNumber, (chkScope.Checked ? 1 : 0), (chkSchedule.Checked ? 1 : 0), txtPCRScheduleDS.Text, txtPCRScheduleDE.Text, txtPCRSchedulePS.Text, txtPCRSchedulePE.Text, txtPCRScheduleES.Text, txtPCRScheduleEE.Text, txtPCRScheduleCS.Text, txtPCRScheduleCE.Text, (chkFinancial.Checked ? 1 : 0), txtPCRFinancialD.Text, txtPCRFinancialP.Text, txtPCRFinancialE.Text, txtPCRFinancialC.Text, strReason, strPath, intCC);
            // Run routing
            oTPM.AddPCRDetail(intId, 1, intLead, 0);
            oTPM.AddPCRDetail(intId, 2, intWorking, -10);
            oTPM.AddPCRDetail(intId, 3, intExecutive, -10);
            if (Request.Form[hdnPCRD.UniqueID] != "")
                oTPM.AddPCRDetail(intId, 4, Int32.Parse(Request.Form[hdnPCRD.UniqueID]), -10);
            oTPM.ApprovePCR(intId, 1, 0, intPCRPage, intWorkloadManager, strBCC);
            Response.Redirect(Request.Path + "?rrid=" + lblRequest.Text + "&div=I&save=true");
        }
        Response.Redirect(Request.Path + "?rrid=" + lblRequest.Text + "&div=I");
    }
    private void Notify(string _to, string _text, bool _resources)
    {
        string strCC = "";
        if (_resources == true)
        {
            DataSet dsNotify = oResourceRequest.GetProjectAll(intProject);
            foreach (DataRow dr in dsNotify.Tables[0].Rows)
                strCC += oUser.GetName(Int32.Parse(dr["userid"].ToString())) + ";";
        }
        string strEmail = oUser.GetName(Int32.Parse(oProject.Get(intProject, "userid"))) + ";";
        strEmail += oUser.GetName(oRequest.GetUser(intRequest)) + ";";
        oFunction.SendEmail("ClearView Notification", strEmail, strCC + _to, strBCC, "ClearView Notification", "<p><b>This message is to notify you that the following project has been modified...</b></p><p>" + oProject.GetBody(intProject, intEnvironment, true) + "</p><p><br/><span style=\"color:#0000FF\"><b>Description of Change(s):</b></span></p><p><ul>" + _text + "</ul></p>", true, false);
    }
</script>
<script type="text/javascript">
    function ChangeFrame(oCell, oShow, oHide1, oHide2, oHide3, oHidden, strHidden) {
        oShow = document.getElementById(oShow);
        oShow.style.display = "inline";
        oHide1 = document.getElementById(oHide1);
        oHide1.style.display = "none";
        oHide2 = document.getElementById(oHide2);
        oHide2.style.display = "none";
        oHide3 = document.getElementById(oHide3);
        oHide3.style.display = "none";
    	var oRow = oCell.parentElement;
	    for (var yy=0; yy<oRow.children.length; yy++) {
    		var oNot = oRow.getElementsByTagName("td").item(yy);
    		if (oNot.className == "cmbutton")
                oNot.style.border = "1px solid #94a6b5"
    	}
	    oCell.style.borderTop = "3px solid #6A8359"
        oCell.style.borderBottom = "1px solid #FFFFFF"
        oHidden = document.getElementById(oHidden);
        oHidden.value = strHidden;
    }
    var keepDescription = null;
    var newDescription = null;
    function DescriptionDown(oText) {
        if (keepDescription == null)
        {
            keepDescription = oText.value;
            newDescription = keepDescription;
        }
    }
    function DescriptionUp(oText) {
        if (oText.value.indexOf(keepDescription) == 0) {
            newDescription = oText.value;
        }
        else {
            alert('NOTE: You cannot change the description. You can only add additional information.');
            oText.value = newDescription;
        }
    }
    function CheckCSRC(o1,o2,o3,o4,oDiv) {
        o1 = document.getElementById(o1);
        o2 = document.getElementById(o2);
        o3 = document.getElementById(o3);
        o4 = document.getElementById(o4);
        oDiv = document.getElementById(oDiv);
        if (o1.checked == true || o2.checked == true || o3.checked == true || o4.checked == true)
            oDiv.style.display = "inline";
        else
            oDiv.style.display = "none";
    }
    function ValidateCSRC(chkD,chkP,chkE,chkC,oFile,SD,ED,ID,ExD,HD,SP,EP,IP,ExP,HP,SE,EE,IE,ExE,HE,SC,EC,IC,ExC,HC) {
        chkD = document.getElementById(chkD);
        chkP = document.getElementById(chkP);
        chkE = document.getElementById(chkE);
        chkC = document.getElementById(chkC);
        if (chkD.checked == false && chkP.checked == false && chkE.checked == false && chkC.checked == false) {
            alert('You must select at least on phase');
            return false;
        }
        else {
            oFile = document.getElementById(oFile);
            if (oFile.value == "") {
                alert('Please select a CSRC document to attach to this request');
                oFile.focus();
                return false;
            }
            if ((chkD.checked == false || (chkD.checked == true && ValidateDate(SD,'Please enter a valid start date') && ValidateDate(ED,'Please enter a valid end date') && ValidateNumber(ID,'Please enter a valid cost') && ValidateNumber(ExD,'Please enter a valid cost') && ValidateNumber(HD,'Please enter a valid cost')))
                     && (chkP.checked == false || (chkP.checked == true && ValidateDate(SP,'Please enter a valid start date') && ValidateDate(EP,'Please enter a valid end date') && ValidateNumber(IP,'Please enter a valid cost') && ValidateNumber(ExP,'Please enter a valid cost') && ValidateNumber(HP,'Please enter a valid cost')))
                     && (chkE.checked == false || (chkE.checked == true && ValidateDate(SE,'Please enter a valid start date') && ValidateDate(EE,'Please enter a valid end date') && ValidateNumber(IE,'Please enter a valid cost') && ValidateNumber(ExE,'Please enter a valid cost') && ValidateNumber(HE,'Please enter a valid cost')))
                     && (chkC.checked == false || (chkC.checked == true && ValidateDate(SC,'Please enter a valid start date') && ValidateDate(EC,'Please enter a valid end date') && ValidateNumber(IC,'Please enter a valid cost') && ValidateNumber(ExC,'Please enter a valid cost') && ValidateNumber(HC,'Please enter a valid cost'))))
                return true;
            else
                return false;
        }
        return true;
    }
    function ValidatePCR(chkScope,chkSched,chkSD,DS,DE,chkSP,PS,PE,chkSE,ES,EE,chkSC,CS,CE,chkF,chkFD,D,chkFP,P,chkFE,E,chkFC,C,oFile) {
        chkScope = document.getElementById(chkScope);
        chkSched = document.getElementById(chkSched);
        chkF = document.getElementById(chkF);
        if (chkScope.checked == false && chkSched.checked == false && chkF.checked == false) {
            alert('Please select at least one cause for the change: Scope, Schedule and/or Financial');
            return false;
        }
        var oStop = false;
        if (chkSched.checked == true) {
            chkSD = document.getElementById(chkSD);
            chkSP = document.getElementById(chkSP);
            chkSE = document.getElementById(chkSE);
            chkSC = document.getElementById(chkSC);
            if (chkSD.checked == false && chkSP.checked == false && chkSE.checked == false && chkSC.checked == false) {
                oStop = true;
                alert('Please select at least one phase to change');
            }
            else if ((chkSD.checked == false || (chkSD.checked == true && ValidateDate(DS,'Please enter a valid start date') && ValidateDate(DE,'Please enter a valid end date')))
                    && (chkSP.checked == false || (chkSP.checked == true && ValidateDate(PS,'Please enter a valid start date') && ValidateDate(PE,'Please enter a valid end date')))
                    && (chkSE.checked == false || (chkSE.checked == true && ValidateDate(ES,'Please enter a valid start date') && ValidateDate(EE,'Please enter a valid end date')))
                    && (chkSC.checked == false || (chkSC.checked == true && ValidateDate(CS,'Please enter a valid start date') && ValidateDate(CE,'Please enter a valid end date'))))
                oStop = false;
            else
                oStop = true;
        }
        if (oStop == true)
            return false;
        if (chkF.checked == true) {
            chkFD = document.getElementById(chkFD);
            chkFP = document.getElementById(chkFP);
            chkFE = document.getElementById(chkFE);
            chkFC = document.getElementById(chkFC);
            if (chkFD.checked == false && chkFP.checked == false && chkFE.checked == false && chkFC.checked == false) {
                oStop = true;
                alert('Please select at least one phase to change');
            }
            else if ((chkFD.checked == false || (chkFD.checked == true && ValidateNumber(D,'Please enter a valid dollar amount')))
                    && (chkFP.checked == false || (chkFP.checked == true && ValidateNumber(P,'Please enter a valid dollar amount')))
                    && (chkFE.checked == false || (chkFE.checked == true && ValidateNumber(E,'Please enter a valid dollar amount')))
                    && (chkFC.checked == false || (chkFC.checked == true && ValidateNumber(C,'Please enter a valid dollar amount'))))
                oStop = false;
             else
                oStop = true;
        }
        if (oStop == true)
            return false;
        oFile = document.getElementById(oFile);
        if (oFile.value == "") {
            alert('Please select a PCR document to attach to this request');
            oFile.focus();
            return false;
        }
        else
            return true;
    }
function MoveList(ddlFrom, ddlTo, oHidden, ddlUpdate) {
    ddlFrom = document.getElementById(ddlFrom);
    ddlTo = document.getElementById(ddlTo);
    ddlUpdate = document.getElementById(ddlUpdate);
	if (ddlFrom.selectedIndex > -1) {
		var oOption = document.createElement("OPTION");
		ddlTo.add(oOption);
		oOption.text = ddlFrom.options[ddlFrom.selectedIndex].text;
		oOption.value = ddlFrom.options[ddlFrom.selectedIndex].value;
		ddlFrom.remove(ddlFrom.selectedIndex);
		ddlTo.selectedIndex = ddlTo.length - 1;
		UpdateHidden(oHidden, ddlUpdate);
	}
	return false;
}
function UpdateHidden(oHidden, oControl) {
	var oHidden = document.getElementById(oHidden);
	oHidden.value = "";
	for (var ii=0; ii<oControl.length; ii++) {
		oHidden.value = oHidden.value + oControl.options[ii].value + "&";
	}
}
</script>
<asp:Panel ID="panWorkload" runat="server" Visible="false">
    <table width="100%" border="0" cellSpacing="0" cellPadding="0" class="default">
        <tr>
            <td>
                <table width="100%" border="0" cellSpacing="0" cellPadding="0">
                    <tr>
                        <td><asp:ImageButton ID="btnSave" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/tool_save.gif" OnClick="btnSave_Click" /></td>
                        <td><asp:ImageButton ID="btnPrint" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/tool_print.gif" /></td>
                        <td><asp:ImageButton ID="btnEmail" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/tool_email.gif" /></td>
                        <td><asp:ImageButton ID="btnSLA" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/tool_sla.gif" /></td>
                        <td><asp:ImageButton ID="btnComplete" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/tool_complete.gif" OnClick="btnComplete_Click" /></td>
                        <td width="100%">
                            <table width="100%" cellpadding="0" cellspacing="0" border="0">
                                <tr>
                                    <td><img src="/images/tool_left.gif" border="0" width="6" height="26"></td>
                                    <td nowrap background="/images/tool_back.gif" width="100%"><img src="/images/tool_back.gif" border="0" width="2" height="26"></td>
                                    <td><img src="/images/tool_right.gif" border="0" width="6" height="26"></td>
                                </tr>
                            </table>
                        </td>
                        <td><asp:ImageButton ID="btnClose" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/tool_close.gif" /></td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td class="default">
                <table width="100%" border="0" cellSpacing="2" cellPadding="2" class="default">
                    <tr>
                        <td valign="top">
                            <table width="100%" border="0" cellSpacing="2" cellPadding="2" class="default">
                                <tr>
                                    <td nowrap><b>Project Name:</b></td>
                                    <td width="100%"><asp:Label ID="lblName" runat="server" CssClass="default" /></td>
                                </tr>
                                <tr>
                                    <td nowrap><b>Clarity Number:</b></td>
                                    <td width="100%"><asp:Label ID="lblNumber" runat="server" CssClass="default" /></td>
                                </tr>
                                <tr>
                                    <td nowrap><b>Sponsoring Portfolio:</b></td>
                                    <td width="100%"><asp:Label ID="lblPortfolio" runat="server" CssClass="default" /></td>
                                </tr>
                                <tr>
                                    <td nowrap><b>Executive Sponsor:</b></td>
                                    <td width="100%"><asp:Label ID="lblExecutive" runat="server" CssClass="default" /></td>
                                </tr>
                                <tr>
                                    <td nowrap><b>Working Sponsor:</b></td>
                                    <td width="100%"><asp:Label ID="lblWorking" runat="server" CssClass="default" /></td>
                                </tr>
                                <tr>
                                    <td nowrap><b>Submitted By:</b></td>
                                    <td width="100%"><asp:Label ID="lblSubmittedBy" runat="server" CssClass="default" /></td>
                                </tr>
                                <tr>
                                    <td nowrap><b>Date Submitted:</b></td>
                                    <td width="100%"><asp:Label ID="lblSubmitted" runat="server" CssClass="default" /></td>
                                </tr>
                                <tr>
                                    <td colspan="2"><asp:HyperLink ID="hypView" runat="server" Target="_blank" /></td>
                                </tr>
                            </table>
                        </td>
                        <td valign="top">
                            <table width="100%" border="0" cellSpacing="2" cellPadding="2" class="default">
                                <tr>
                                    <td nowrap><b>Approved End Date:</b></td>
                                    <td width="100%"><asp:Label ID="lblEndDate" runat="server" CssClass="default" /></td>
                                </tr>
                                <tr>
                                    <td nowrap><b>Total Approved:</b></td>
                                    <td width="100%">$<asp:Label ID="lblTotalApproved" runat="server" CssClass="default" /></td>
                                </tr>
                                <tr>
                                    <td nowrap><b>Total Actual:</b></td>
                                    <td width="100%">$<asp:Label ID="lblTotalActual" runat="server" CssClass="default" /></td>
                                </tr>
                                <tr>
                                    <td nowrap><b>Variance:</b></td>
                                    <td width="100%">$<asp:Label ID="lblTotalVariance" runat="server" CssClass="default" /></td>
                                </tr>
                                <tr>
                                    <td nowrap><b>Overall Priority:</b></td>
                                    <td width="100%"><asp:Label ID="lblPriority" runat="server" CssClass="default" /></td>
                                </tr>
                                <tr>
                                    <td nowrap><b>Overall Status:</b></td>
                                    <td width="100%"><asp:Label ID="lblStatus" runat="server" CssClass="default" /></td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr height="16">
            <td><img src="/images/spacer.gif" border="0" height="16" width="1" /></td>
        </tr>
        <tr>
            <td>
                    <table width="100%" height="100%" border="0" cellSpacing="0" cellPadding="0" class="default">
                        <tr>
                            <td class="cmbutton" style='<%=boolDetails == true ? "display:inline;border-bottom:1px solid #FFFFFF;border-top:3px solid #6A8359;" : "" %>' onclick="ChangeFrame(this,'divDetails','divStatus','divInformation','divClose','<%=hdnTab.ClientID %>','D');">Project Details</td>
                            <td class="cmbuttonspace">&nbsp;</td>
                            <td class="cmbutton" style='<%=boolStatus == true ? "display:inline;border-bottom:1px solid #FFFFFF;border-top:3px solid #6A8359;" : "" %>' onclick="ChangeFrame(this,'divStatus','divDetails','divInformation','divClose','<%=hdnTab.ClientID %>','S');">Weekly Status</td>
                            <td class="cmbuttonspace">&nbsp;</td>
                            <td class="cmbutton" style='<%=boolInformation == true ? "display:inline;border-bottom:1px solid #FFFFFF;border-top:3px solid #6A8359;" : "" %>' onclick="ChangeFrame(this,'divInformation','divDetails','divStatus','divClose','<%=hdnTab.ClientID %>','I');">CSRC/PCR Information</td>
                            <td class="cmbuttonspace">&nbsp;</td>
                            <td class="cmbutton" style='<%=boolClose == true ? "display:inline;border-bottom:1px solid #FFFFFF;border-top:3px solid #6A8359;" : "" %>' onclick="ChangeFrame(this,'divClose','divDetails','divStatus','divInformation','<%=hdnTab.ClientID %>','C');">Close</td>
                        </tr>
                        <tr>
                            <td colspan="7" align="center" class="cmcontents">
                                <table width="100%" height="100%" border="0" cellSpacing="2" cellPadding="2" class="default">
                                    <tr> 
                                        <td valign="top">
		                                    <div id="divDetails" style='<%=boolDetails == true ? "display:inline" : "display:none" %>'>
		                                        <br /><br /><br />
                                                <table width="100%" cellpadding="3" cellspacing="2" border="0" class="default">
                                                    <tr>
                                                        <td nowrap style="color:#404040"><b>Project Name:</b></td>
                                                        <td width="100%"><asp:TextBox ID="txtProjectName1" runat="server" CssClass="default" Width="300" MaxLength="35" /></td>
                                                    </tr>
                                                    <tr>
                                                        <td nowrap style="color:#404040"><b>Clarity Number:</b></td>
                                                        <td width="100%"><asp:TextBox ID="txtProjectNumber" runat="server" CssClass="default" Width="100" MaxLength="7" /> <img src="/images/question_red.gif" border="0" align="absmiddle" /></td>
                                                    </tr>
                                                    <tr>
                                                        <td nowrap><b>Executive Sponsor:</b></td>
                                                        <td width="100%">
                                                            <table cellpadding="0" cellspacing="0" border="0">
                                                                <tr>
                                                                    <td><asp:TextBox ID="txtExecutive" runat="server" Width="200" CssClass="default" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td>
                                                                        <div id="divExecutive" runat="server" style="overflow:hidden; position:absolute; display:none; background-color:#FFFFFF; border:solid 1px #CCCCCC">
                                                                            <asp:ListBox ID="lstExecutive" runat="server" CssClass="default" />
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td nowrap><b>Working Sponsor:</b></td>
                                                        <td width="100%">
                                                            <table cellpadding="0" cellspacing="0" border="0">
                                                                <tr>
                                                                    <td><asp:TextBox ID="txtWorking" runat="server" Width="200" CssClass="default" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td>
                                                                        <div id="divWorking" runat="server" style="overflow:hidden; position:absolute; display:none; background-color:#FFFFFF; border:solid 1px #CCCCCC">
                                                                            <asp:ListBox ID="lstWorking" runat="server" CssClass="default" />
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td nowrap><b>Portfolio:</b></td>
                                                        <td width="100%"><asp:DropDownList ID="ddlPortfolio" runat="server" CssClass="default" Width="200" /></td>
                                                    </tr>
                                                    <tr>
                                                        <td nowrap valign="top"><b>Project Description:</b></td>
                                                        <td width="100%"><asp:TextBox ID="txtDescription" runat="server" CssClass="default" Width="400" TextMode="MultiLine" Rows="7" /></td>
                                                    </tr>
                                                    <tr>
                                                        <td nowrap><b>Date TPM/PC Assigned:</b></td>
                                                        <td width="100%"><asp:Label ID="lblAssigned" runat="server" CssClass="default" /></td>
                                                    </tr>
                                                    <tr>
                                                        <td nowrap><b>Estimated Start Date:</b></td>
                                                        <td width="100%"><asp:Label ID="lblStart" runat="server" CssClass="default" /></td>
                                                    </tr>
                                                    <tr>
                                                        <td nowrap><b>Estimated End Date:</b></td>
                                                        <td width="100%"><asp:Label ID="lblEnd" runat="server" CssClass="default" /></td>
                                                    </tr>
                                                    <tr>
                                                        <td nowrap><b>Project Start Date:</b></td>
                                                        <td width="100%"><asp:TextBox ID="CV_FIELD_10043" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgStart" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                    </tr>
                                                    <tr>
                                                        <td valign="top"><br /><b>Cost Center(s):</b></td>
                                                        <td>
                                                            <table cellpadding="2" cellspacing="0" border="0">
                                                                <tr>
                                                                    <td class="default">Selected:</td>
                                                                    <td class="default" colspan="3">&nbsp;</td>
                                                                    <td class="default">Available:</td>
                                                                </tr>
                                                                <tr>
                                                                    <td><asp:ListBox ID="lstCostsCurrent" runat="server" Width="175" CssClass="default" Rows="5" /></td>
                                                                    <td>&nbsp;</td>
                                                                    <td>
                                                                        <asp:ImageButton ID="btnCostAdd" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/lt.gif" ToolTip="Add" /><br /><br />
                                                                        <asp:ImageButton ID="btnCostRemove" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/rt.gif" ToolTip="Remove" />
                                                                    </td>
                                                                    <td>&nbsp;</td>
                                                                    <td><asp:ListBox ID="lstCostsAvailable" runat="server" Width="175" CssClass="default" Rows="5" /></td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td nowrap><b>Project Central SharePoint URL:</b></td>
                                                        <td width="100%">
                                                            <table cellpadding="0" cellspacing="0" border="0">
                                                                <tr>
                                                                    <td><asp:TextBox ID="CV_FIELD_10156" runat="server" CssClass="default" Width="400" /></td>
                                                                    <td>&nbsp;</td>
                                                                    <td><asp:HyperLink ID="hypSharepoint" runat="server" ImageUrl="/images/search.gif" Target="_blank" /></td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2">&nbsp;</td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2">&nbsp;</td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2" class="hugeheader">My Documents&nbsp;&nbsp;&nbsp;<asp:Button ID="btnStrategic" runat="server" Text="Upload" Width="75" CssClass="default" /></td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2"><asp:Label ID="lblDocuments" runat="server" CssClass="default" /></td>
                                                    </tr>
                                                </table>
		                                    </div>
		                                    <div id="divStatus" style='<%=boolStatus == true ? "display:inline" : "display:none" %>'>
		                                        <br /><br /><br />
                                                <table width="100%" cellpadding="5" cellspacing="0" border="0">
                                                    <tr>
                                                        <td nowrap><b>Project Name:</b></td>
                                                        <td width="100%"><asp:TextBox ID="txtProjectName2" runat="server" CssClass="default" Width="300" MaxLength="35" /></td>
                                                    </tr>
                                                    <tr>
                                                        <td nowrap><b>Project Status:</b></td>
                                                        <td width="100%">
                                                            <asp:DropDownList ID="ddlStatus" runat="server" CssClass="default" Width="100">
                                                                <asp:ListItem Value="2" Text="Active" />
                                                                <asp:ListItem Value="5" Text="Hold" />
                                                                <asp:ListItem Value="-2" Text="Cancelled" />
                                                            </asp:DropDownList>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td nowrap><b>Current PMM Phase:</b></td>
                                                        <td width="100%">
                                                            <asp:DropDownList ID="CV_FIELD_10111" runat="server" CssClass="default" Width="100">
                                                                <asp:ListItem Value="Idea" />
                                                                <asp:ListItem Value="Discovery" />
                                                                <asp:ListItem Value="Planning" />
                                                                <asp:ListItem Value="Execution" />
                                                                <asp:ListItem Value="Closing" />
                                                            </asp:DropDownList>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2">&nbsp;</td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2" class="hugeheader">Project Schedule:</td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2">
                                                            <table width="90%" cellpadding="5" cellspacing="0" border="0" style="display:inline">
                                                                <tr>
                                                                    <td bgcolor="#E9E9E9" style="border-bottom:solid 1px #999999;border-top:solid 1px #999999;border-left:solid 1px #999999">&nbsp;</td>
                                                                    <td align="center" colspan="3" bgcolor="#E9E9E9" style="border-bottom:solid 1px #999999;border-top:solid 1px #999999"><b>Approved C1 Dates</b></td>
                                                                    <td align="center" colspan="3" bgcolor="#E9E9E9" style="border-bottom:solid 1px #999999;border-top:solid 1px #999999"><b>Project Timeline</b></td>
                                                                    <td align="center" rowspan="2" bgcolor="#E9E9E9" class="default" style="border-top:solid 1px #999999"><b>Variance<br /># Days</b></td>
                                                                    <td align="center" rowspan="2" bgcolor="#E9E9E9" class="default" style="border-top:solid 1px #999999;border-right:solid 1px #999999"><b>Variance<br />%</b></td>
                                                                </tr>
                                                                <tr>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center" class="greenheader"><b>Start Date</b></td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center" class="greenheader"><b>End Date</b></td>
                                                                    <td align="center" class="greenheader"><b>Start Date</b></td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center" class="greenheader" style="border-right:solid 1px #999999"><b>End Date</b></td>
                                                                </tr>
                                                                <tr>
                                                                    <td nowrap>Discovery Phase:</td>
                                                                    <td align="center" nowrap><asp:TextBox ID="CV_FIELD_10112" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10112" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                    <td align="center" width="1">-</td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10113" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10113" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                    <td align="center" nowrap><asp:TextBox ID="CV_FIELD_10044" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10044" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                    <td align="center" width="1">-</td>
                                                                    <td align="center" style="border-right:solid 1px #999999"><asp:TextBox ID="CV_FIELD_10045" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10045" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center"><asp:Label ID="lblVarianceDaysD" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-right:solid 1px #999999"><asp:Label ID="lblVariancePercentD" runat="server" CssClass="default" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td nowrap>Planning Phase:</td>
                                                                    <td align="center" nowrap><asp:TextBox ID="CV_FIELD_10114" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10114" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                    <td align="center" width="1">-</td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10115" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10115" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                    <td align="center" nowrap><asp:TextBox ID="CV_FIELD_10046" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10046" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                    <td align="center" width="1">-</td>
                                                                    <td align="center" style="border-right:solid 1px #999999"><asp:TextBox ID="CV_FIELD_10047" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10047" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center"><asp:Label ID="lblVarianceDaysP" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-right:solid 1px #999999"><asp:Label ID="lblVariancePercentP" runat="server" CssClass="default" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td nowrap>Execution Phase:</td>
                                                                    <td align="center" nowrap><asp:TextBox ID="CV_FIELD_10116" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10116" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                    <td align="center" width="1">-</td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10117" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10117" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                    <td align="center" nowrap><asp:TextBox ID="CV_FIELD_10048" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10048" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                    <td align="center" width="1">-</td>
                                                                    <td align="center" style="border-right:solid 1px #999999"><asp:TextBox ID="CV_FIELD_10049" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10049" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center"><asp:Label ID="lblVarianceDaysE" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-right:solid 1px #999999"><asp:Label ID="lblVariancePercentE" runat="server" CssClass="default" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td nowrap>Close Phase:</td>
                                                                    <td align="center" nowrap><asp:TextBox ID="CV_FIELD_10118" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10118" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                    <td align="center" width="1">-</td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10119" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10119" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                    <td align="center" nowrap><asp:TextBox ID="CV_FIELD_10050" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10050" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                    <td align="center" width="1">-</td>
                                                                    <td align="center" style="border-right:solid 1px #999999"><asp:TextBox ID="CV_FIELD_10051" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10051" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center"><asp:Label ID="lblVarianceDaysC" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-right:solid 1px #999999"><asp:Label ID="lblVariancePercentC" runat="server" CssClass="default" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td bgcolor="#E9E9E9" style="border-bottom:solid 1px #999999;border-top:solid 1px #999999;border-left:solid 1px #999999" class="default"><b>PROJECT TOTALS:</b></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-top:solid 1px #999999;border-bottom:solid 1px #999999"><asp:Label ID="lblApprovedStart" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-top:solid 1px #999999;border-bottom:solid 1px #999999">-</td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-top:solid 1px #999999;border-bottom:solid 1px #999999"><asp:Label ID="lblApprovedEnd" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-top:solid 1px #999999;border-bottom:solid 1px #999999"><asp:Label ID="lblProjectStart" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-top:solid 1px #999999;border-bottom:solid 1px #999999">-</td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-top:solid 1px #999999;border-bottom:solid 1px #999999"><asp:Label ID="lblProjectEnd" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-bottom:solid 1px #999999"><asp:Label ID="lblVarianceDays" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-bottom:solid 1px #999999;border-right:solid 1px #999999"><asp:Label ID="lblVariancePercent" runat="server" CssClass="defaultbold" /></td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2">&nbsp;</td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2">&nbsp;</td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2" class="hugeheader">Project Financials:</td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2">
                                                            <table width="100%" cellpadding="5" cellspacing="0" border="0">
                                                                <tr>
                                                                    <td align="left" class="header"><b>Discovery:</b></td>
                                                                    <td align="center" class="greenheader"><b>Approved C1</b></td>
                                                                    <td align="center" class="greenheader"><b>Actuals to Date</b></td>
                                                                    <td align="center" class="greenheader"><b>Estimate to Complete</b></td>
                                                                    <td bgcolor="#E9E9E9" class="default" align="center" style="border-left:solid 1px #999999;border-top:solid 1px #999999"><b>Current Forecast</b></td>
                                                                    <td bgcolor="#E9E9E9" class="default" align="center" style="border-top:solid 1px #999999"><b>Variance $</b></td>
                                                                    <td bgcolor="#E9E9E9" class="default" align="center" style="border-top:solid 1px #999999;border-right:solid 1px #999999"><b>Variance %</b></td>
                                                                </tr>
                                                                <tr>
                                                                    <td>Internal Labor:</td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10120" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10120" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10123" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10123" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10126" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10126" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-left:solid 1px #999999"><asp:Label ID="lblForeDI" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center"><asp:Label ID="lblVarDDI" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-right:solid 1px #999999"><asp:Label ID="lblVarPDI" runat="server" CssClass="default" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td>External Labor:</td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10121" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10121" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10124" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10124" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10127" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10127" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-left:solid 1px #999999"><asp:Label ID="lblForeDE" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center"><asp:Label ID="lblVarDDE" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-right:solid 1px #999999"><asp:Label ID="lblVarPDE" runat="server" CssClass="default" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td>HW/SW/One Time Cost:</td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10122" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10122" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10125" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10125" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10128" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10128" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-left:solid 1px #999999"><asp:Label ID="lblForeDH" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center"><asp:Label ID="lblVarDDH" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-right:solid 1px #999999"><asp:Label ID="lblVarPDH" runat="server" CssClass="default" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td bgcolor="#E9E9E9" style="border-top:solid 1px #999999;border-left:solid 1px #999999" class="default"><b>PHASE TOTALS:</b></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-top:solid 1px #999999"><asp:Label ID="lblAppD" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-top:solid 1px #999999"><asp:Label ID="lblActD" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-top:solid 1px #999999"><asp:Label ID="lblEstimateD" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center"><asp:Label ID="lblForeD" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center"><asp:Label ID="lblVarDD" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-right:solid 1px #999999"><asp:Label ID="lblVarPD" runat="server" CssClass="defaultbold" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td colspan="4" style="border-top:solid 1px #999999"><img src="/images/spacer.gif" border="0" width="1" height="1" /></td>
                                                                    <td colspan="3" style="border-bottom:solid 1px #999999;border-top:solid 1px #999999"><img src="/images/spacer.gif" border="0" width="1" height="1" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td align="left" class="header"><b>Planning:</b></td>
                                                                    <td align="center" class="greenheader"><b>Approved C1</b></td>
                                                                    <td align="center" class="greenheader"><b>Actuals to Date</b></td>
                                                                    <td align="center" class="greenheader"><b>Estimate to Complete</b></td>
                                                                    <td bgcolor="#E9E9E9" class="default" align="center" style="border-left:solid 1px #999999"><b>Current Forecast</b></td>
                                                                    <td bgcolor="#E9E9E9" class="default" align="center"><b>Variance $</b></td>
                                                                    <td bgcolor="#E9E9E9" class="default" align="center" style="border-right:solid 1px #999999"><b>Variance %</b></td>
                                                                </tr>
                                                                <tr>
                                                                    <td>Internal Labor:</td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10129" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10129" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10132" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10132" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10135" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10135" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-left:solid 1px #999999"><asp:Label ID="lblForePI" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center"><asp:Label ID="lblVarDPI" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-right:solid 1px #999999"><asp:Label ID="lblVarPPI" runat="server" CssClass="default" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td>External Labor:</td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10130" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10130" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10133" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10133" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10136" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10136" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-left:solid 1px #999999"><asp:Label ID="lblForePE" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center"><asp:Label ID="lblVarDPE" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-right:solid 1px #999999"><asp:Label ID="lblVarPPE" runat="server" CssClass="default" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td>HW/SW/One Time Cost:</td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10131" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10131" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10134" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10134" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10137" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10137" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-left:solid 1px #999999"><asp:Label ID="lblForePH" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center"><asp:Label ID="lblVarDPH" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-right:solid 1px #999999"><asp:Label ID="lblVarPPH" runat="server" CssClass="default" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td bgcolor="#E9E9E9" style="border-top:solid 1px #999999;border-left:solid 1px #999999" class="default"><b>PHASE TOTALS:</b></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-top:solid 1px #999999"><asp:Label ID="lblAppP" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-top:solid 1px #999999"><asp:Label ID="lblActP" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-top:solid 1px #999999"><asp:Label ID="lblEstimateP" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center"><asp:Label ID="lblForeP" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center"><asp:Label ID="lblVarDP" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-right:solid 1px #999999"><asp:Label ID="lblVarPP" runat="server" CssClass="defaultbold" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td colspan="4" style="border-top:solid 1px #999999"><img src="/images/spacer.gif" border="0" width="1" height="1" /></td>
                                                                    <td colspan="3" style="border-bottom:solid 1px #999999;border-top:solid 1px #999999"><img src="/images/spacer.gif" border="0" width="1" height="1" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td align="left" class="header"><b>Execution:</b></td>
                                                                    <td align="center" class="greenheader"><b>Approved C1</b></td>
                                                                    <td align="center" class="greenheader"><b>Actuals to Date</b></td>
                                                                    <td align="center" class="greenheader"><b>Estimate to Complete</b></td>
                                                                    <td bgcolor="#E9E9E9" class="default" align="center" style="border-left:solid 1px #999999"><b>Current Forecast</b></td>
                                                                    <td bgcolor="#E9E9E9" class="default" align="center"><b>Variance $</b></td>
                                                                    <td bgcolor="#E9E9E9" style="border-right:solid 1px #999999" class="default" align="center"><b>Variance %</b></td>
                                                                </tr>
                                                               <tr>
                                                                    <td>Internal Labor:</td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10138" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10138" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10141" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10141" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10144" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10144" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-left:solid 1px #999999"><asp:Label ID="lblForeEI" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center"><asp:Label ID="lblVarDEI" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-right:solid 1px #999999"><asp:Label ID="lblVarPEI" runat="server" CssClass="default" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td>External Labor:</td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10139" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10139" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10142" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10142" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10145" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10145" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-left:solid 1px #999999"><asp:Label ID="lblForeEE" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center"><asp:Label ID="lblVarDEE" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-right:solid 1px #999999"><asp:Label ID="lblVarPEE" runat="server" CssClass="default" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td>HW/SW/One Time Cost:</td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10140" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10140" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10143" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10143" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10146" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10146" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-left:solid 1px #999999"><asp:Label ID="lblForeEH" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center"><asp:Label ID="lblVarDEH" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-right:solid 1px #999999"><asp:Label ID="lblVarPEH" runat="server" CssClass="default" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td bgcolor="#E9E9E9" style="border-top:solid 1px #999999;border-left:solid 1px #999999" class="default"><b>PHASE TOTALS:</b></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-top:solid 1px #999999"><asp:Label ID="lblAppE" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-top:solid 1px #999999"><asp:Label ID="lblActC" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-top:solid 1px #999999"><asp:Label ID="lblEstimateE" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center"><asp:Label ID="lblForeE" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center"><asp:Label ID="lblVarDE" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-right:solid 1px #999999"><asp:Label ID="lblVarPE" runat="server" CssClass="defaultbold" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td colspan="4" style="border-top:solid 1px #999999"><img src="/images/spacer.gif" border="0" width="1" height="1" /></td>
                                                                    <td colspan="3" style="border-bottom:solid 1px #999999;border-top:solid 1px #999999"><img src="/images/spacer.gif" border="0" width="1" height="1" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td align="left" class="header"><b>Closing:</b></td>
                                                                    <td align="center" class="greenheader"><b>Approved C1</b></td>
                                                                    <td align="center" class="greenheader"><b>Actuals to Date</b></td>
                                                                    <td align="center" class="greenheader"><b>Estimate to Complete</b></td>
                                                                    <td bgcolor="#E9E9E9" class="default" align="center" style="border-left:solid 1px #999999"><b>Current Forecast</b></td>
                                                                    <td bgcolor="#E9E9E9" class="default" align="center"><b>Variance $</b></td>
                                                                    <td bgcolor="#E9E9E9" class="default" align="center" style="border-right:solid 1px #999999"><b>Variance %</b></td>
                                                                </tr>
                                                                <tr>
                                                                    <td>Internal Labor:</td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10147" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10147" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10150" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10150" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10153" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10153" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-left:solid 1px #999999"><asp:Label ID="lblForeCI" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center"><asp:Label ID="lblVarDCI" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-right:solid 1px #999999"><asp:Label ID="lblVarPCI" runat="server" CssClass="default" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td>External Labor:</td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10148" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10148" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10151" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10151" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10154" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10154" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-left:solid 1px #999999"><asp:Label ID="lblForeCE" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center"><asp:Label ID="lblVarDCE" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-right:solid 1px #999999"><asp:Label ID="lblVarPCE" runat="server" CssClass="default" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td>HW/SW/One Time Cost:</td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10149" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10149" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10152" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10152" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td align="center"><asp:TextBox ID="CV_FIELD_10155" runat="server" CssClass="default" Width="80" MaxLength="10" /> <asp:ImageButton ID="imgCV_FIELD_10155" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-left:solid 1px #999999"><asp:Label ID="lblForeCH" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center"><asp:Label ID="lblVarDCH" runat="server" CssClass="default" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-right:solid 1px #999999"><asp:Label ID="lblVarPCH" runat="server" CssClass="default" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td bgcolor="#E9E9E9" style="border-top:solid 1px #999999;border-left:solid 1px #999999" class="default"><b>PHASE TOTALS:</b></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-top:solid 1px #999999"><asp:Label ID="lblAppC" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-top:solid 1px #999999"><asp:Label ID="lblActE" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-top:solid 1px #999999"><asp:Label ID="lblEstimateC" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center"><asp:Label ID="lblForeC" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center"><asp:Label ID="lblVarDC" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-right:solid 1px #999999"><asp:Label ID="lblVarPC" runat="server" CssClass="defaultbold" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td colspan="4" style="border-top:solid 1px #999999"><img src="/images/spacer.gif" border="0" width="1" height="1" /></td>
                                                                    <td colspan="3" style="border-bottom:solid 1px #999999;border-top:solid 1px #999999"><img src="/images/spacer.gif" border="0" width="1" height="1" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td align="left" class="default"></td>
                                                                    <td align="center" class="greenheader"><b>Approved C1</b></td>
                                                                    <td align="center" class="greenheader"><b>Actuals to Date</b></td>
                                                                    <td align="center" class="greenheader"><b>Estimate to Complete</b></td>
                                                                    <td bgcolor="#E9E9E9" class="default" align="center" style="border-left:solid 1px #999999"><b>Current Forecast</b></td>
                                                                    <td bgcolor="#E9E9E9" class="default" align="center"><b>Variance $</b></td>
                                                                    <td bgcolor="#E9E9E9" class="default" align="center" style="border-right:solid 1px #999999"><b>Variance %</b></td>
                                                                </tr>
                                                                <tr>
                                                                    <td bgcolor="#E9E9E9" style="border-bottom:solid 1px #999999;border-top:solid 1px #999999;border-left:solid 1px #999999" class="default"><b>PROJECT TOTALS:</b></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-bottom:solid 1px #999999;border-top:solid 1px #999999"><asp:Label ID="lblApp" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-bottom:solid 1px #999999;border-top:solid 1px #999999"><asp:Label ID="lblAct" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-bottom:solid 1px #999999;border-top:solid 1px #999999"><asp:Label ID="lblEstimate" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-bottom:solid 1px #999999"><asp:Label ID="lblFore" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-bottom:solid 1px #999999"><asp:Label ID="lblVarD" runat="server" CssClass="defaultbold" /></td>
                                                                    <td bgcolor="#E9E9E9" align="center" style="border-bottom:solid 1px #999999;border-right:solid 1px #999999"><asp:Label ID="lblVarP" runat="server" CssClass="defaultbold" /></td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2"><hr size="1" noshade /></td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2" class="hugeheader">Weekly Status:</td>
                                                    </tr>
                                                    <tr>
                                                        <td nowrap><b>Status Date:</b></td>
                                                        <td width="100%"><asp:TextBox ID="txtStatusDate" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgStatusDate" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                    </tr>
                                                    <tr>
                                                        <td nowrap><b>Scope Variance:</b></td>
                                                        <td width="100%">
                                                            <asp:DropDownList ID="ddlScope" runat="server" CssClass="default" >
                                                                <asp:ListItem Text="-- SELECT --" Value="0" />
                                                                <asp:ListItem Text="Red" Value="1" />
                                                                <asp:ListItem Text="Yellow" Value="2" />
                                                                <asp:ListItem Text="Green" Value="3" />
                                                            </asp:DropDownList>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td nowrap><b>Timeline Variance:</b></td>
                                                        <td width="100%">
                                                            <asp:DropDownList ID="ddlTimeline" runat="server" CssClass="default" >
                                                                <asp:ListItem Text="-- SELECT --" Value="0" />
                                                                <asp:ListItem Text="Red" Value="1" />
                                                                <asp:ListItem Text="Yellow" Value="2" />
                                                                <asp:ListItem Text="Green" Value="3" />
                                                            </asp:DropDownList>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td nowrap><b>Budget Variance:</b></td>
                                                        <td width="100%">
                                                            <asp:DropDownList ID="ddlBudget" runat="server" CssClass="default" >
                                                                <asp:ListItem Text="-- SELECT --" Value="0" />
                                                                <asp:ListItem Text="Red" Value="1" />
                                                                <asp:ListItem Text="Yellow" Value="2" />
                                                                <asp:ListItem Text="Green" Value="3" />
                                                            </asp:DropDownList>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td nowrap><b>Comments / Issues:</b></td>
                                                        <td width="100%"><asp:TextBox ID="txtComments" runat="server" CssClass="default" Width="300" TextMode="MultiLine" Rows="5" /></td>
                                                    </tr>
                                                    <tr>
                                                        <td nowrap><b>This Week's<br />Accomplishments:</b></td>
                                                        <td width="100%"><asp:TextBox ID="txtThisWeek" runat="server" CssClass="default" Width="300" TextMode="MultiLine" Rows="5" /></td>
                                                    </tr>
                                                    <tr>
                                                        <td nowrap><b>Next Week's<br />Accomplishments:</b></td>
                                                        <td width="100%"><asp:TextBox ID="txtNextWeek" runat="server" CssClass="default" Width="300" TextMode="MultiLine" Rows="5" /></td>
                                                    </tr>
                                                </table>
                                                <br /><br />
                                                <table width="100%" cellpadding="0" cellspacing="0" border="0">
                                                    <tr>
                                                        <td>
                                                            <table width="100%" cellpadding="3" cellspacing="0" border="0" style="border:solid 1px #CCCCCC">
                                                                <tr bgcolor="#EEEEEE">
                                                                    <td nowrap><b>Date</b></td>
                                                                    <td nowrap>&nbsp;</td>
                                                                    <td nowrap align="center"><b>Overall Status</b></td>
                                                                    <td></td>
                                                                    <td nowrap align="center"><b>Scope Status</b></td>
                                                                    <td nowrap align="center"><b>Timeline Status</b></td>
                                                                    <td nowrap align="center"><b>Budget Status</b></td>
                                                                </tr>
                                                                <asp:repeater ID="rptStatus" runat="server">
                                                                    <ItemTemplate>
                                                                        <asp:Label ID="lblScope" runat="server" CssClass="default" Text='<%# DataBinder.Eval(Container.DataItem, "scope") %>' Visible="false" />
                                                                        <asp:Label ID="lblTimeline" runat="server" CssClass="default" Text='<%# DataBinder.Eval(Container.DataItem, "timeline") %>' Visible="false" />
                                                                        <asp:Label ID="lblBudget" runat="server" CssClass="default" Text='<%# DataBinder.Eval(Container.DataItem, "budget") %>' Visible="false" />
                                                                        <tr class="default">
                                                                            <td nowrap><a href="javascript:void(0);" onclick="ShowStatus('<%# DataBinder.Eval(Container.DataItem, "id") %>','t');"><%# DateTime.Parse(DataBinder.Eval(Container.DataItem, "datestamp").ToString()).ToShortDateString() %></a></td>
                                                                            <td nowrap>&nbsp;</td>
                                                                            <td width="30%" align="center"><asp:Label ID="lblStatus" runat="server" CssClass="default" Text='' /></td>
                                                                            <td width="20%">&nbsp;</td>
                                                                            <td width="15%" align="center"><asp:Label ID="lblStatusScope" runat="server" CssClass="default" Text='' /></td>
                                                                            <td width="15%" align="center"><asp:Label ID="lblStatusTimeline" runat="server" CssClass="default" Text='' /></td>
                                                                            <td width="15%" align="center"><asp:Label ID="lblStatusBudget" runat="server" CssClass="default" Text='' /></td>
                                                                        </tr>
                                                                    </ItemTemplate>
                                                                </asp:repeater>
                                                            <tr>
                                                                <td colspan="7">
                                                                    <asp:Label ID="lblNoStatus" runat="server" CssClass="default" Visible="false" Text="<img src='/images/alert.gif' border='0' align='absmiddle'> There are no updates related to this project" />
                                                                </td>
                                                            </tr>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </table>
		                                    </div>
		                                    <div id="divInformation" style='<%=boolInformation == true ? "display:inline" : "display:none" %>'>
		                                        <br /><br /><br />
                                                <table width="100%" cellpadding="4" cellspacing="3" border="0" class="default">
                                                    <tr>
                                                        <td colspan="2" class="hugeheader">Capital Service Review Committee (CSRC) Form</td>
                                                    </tr>
                                                    <tr>
                                                        <td nowrap><b>PMM Phase:</b></td>
                                                        <td width="100%">
                                                            <asp:CheckBox ID="chkDiscovery" Text="Discovery" runat="server" CssClass="default" /> 
                                                            <asp:CheckBox ID="chkPlanning" Text="Planning" runat="server" CssClass="default" /> 
                                                            <asp:CheckBox ID="chkExecution" Text="Execution" runat="server" CssClass="default" /> 
                                                            <asp:CheckBox ID="chkClosing" Text="Closing" runat="server" CssClass="default" />
                                                        </td>
                                                    </tr>
                                                    </tr>
                                                </table>
                                                <div id="divCSRC" runat="server" style="display:none">
                                                    <table width="100%" cellpadding="4" cellspacing="3" border="0" class="default">
                                                        <tr>
                                                            <td nowrap><b>CSRC Document:</b></td>
                                                            <td width="100%"><asp:FileUpload runat="server" ID="oCSRC" Width="500" CssClass="default" /></td>
                                                        </tr>
                                                        <tr>
                                                            <td colspan="2">
                                                                <div id="divDiscovery" runat="server" style="display:none">
                                                                    <br />
                                                                    <table width="100%" cellpadding="0" cellspacing="0" border="0">
                                                                        <tr>
                                                                            <td colspan="3" bgcolor="#6A8359" class="whitedefault"><div style="padding:3"><b>Discovery</b></div></td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td colspan="3" style="border-left:solid 1px #999999;border-right:solid 1px #999999;border-top:solid 1px #999999;">
                                                                                <table width="100%" cellpadding="4" cellspacing="3" border="0" class="default">
                                                                                    <tr>
                                                                                        <td nowrap><b>Phase Start Date:</b></td>
                                                                                        <td width="50%"><asp:TextBox ID="txtCSRCSD" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgCSRCSD" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                                        <td nowrap><b>Internal Labor:</b></td>
                                                                                        <td width="50%"><asp:TextBox ID="txtCSRCID" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgCSRCID" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                                    </tr>
                                                                                    <tr>
                                                                                        <td nowrap><b>Phase End Date:</b></td>
                                                                                        <td width="50%"><asp:TextBox ID="txtCSRCED" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgCSRCED" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                                        <td nowrap><b>External Labor:</b></td>
                                                                                        <td width="50%"><asp:TextBox ID="txtCSRCExD" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgCSRCExD" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                                    </tr>
                                                                                    <tr>
                                                                                        <td nowrap>&nbsp;</td>
                                                                                        <td width="50%">&nbsp;</td>
                                                                                        <td nowrap><b>HW/SW/One Time Cost:</b></td>
                                                                                        <td width="50%"><asp:TextBox ID="txtCSRCHD" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgCSRCHD" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                                    </tr>
                                                                                </table>
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td><img src="/images/shadow_box_l.gif" border="0" width="5" height="12"></td>
                                                                            <td width="100%" background="/images/shadow_box.gif"></td>
                                                                            <td><img src="/images/shadow_box_r.gif" border="0" width="5" height="12"></td>
                                                                        </tr>
                                                                    </table>
                                                                </div>
                                                                <div id="divPlanning" runat="server" style="display:none">
                                                                    <br />
                                                                    <table width="100%" cellpadding="0" cellspacing="0" border="0">
                                                                        <tr>
                                                                            <td colspan="3" bgcolor="#6A8359" class="whitedefault"><div style="padding:3"><b>Planning</b></div></td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td colspan="3" style="border-left:solid 1px #999999;border-right:solid 1px #999999;border-top:solid 1px #999999;">
                                                                                <table width="100%" cellpadding="4" cellspacing="3" border="0" class="default">
                                                                                    <tr>
                                                                                        <td nowrap><b>Phase Start Date:</b></td>
                                                                                        <td width="50%"><asp:TextBox ID="txtCSRCSP" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgCSRCSP" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                                        <td nowrap><b>Internal Labor:</b></td>
                                                                                        <td width="50%"><asp:TextBox ID="txtCSRCIP" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgCSRCIP" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                                    </tr>
                                                                                    <tr>
                                                                                        <td nowrap><b>Phase End Date:</b></td>
                                                                                        <td width="50%"><asp:TextBox ID="txtCSRCEP" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgCSRCEP" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                                        <td nowrap><b>External Labor:</b></td>
                                                                                        <td width="50%"><asp:TextBox ID="txtCSRCExP" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgCSRCExP" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                                    </tr>
                                                                                    <tr>
                                                                                        <td nowrap>&nbsp;</td>
                                                                                        <td width="50%">&nbsp;</td>
                                                                                        <td nowrap><b>HW/SW/One Time Cost:</b></td>
                                                                                        <td width="50%"><asp:TextBox ID="txtCSRCHP" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgCSRCHP" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                                    </tr>
                                                                                </table>
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td><img src="/images/shadow_box_l.gif" border="0" width="5" height="12"></td>
                                                                            <td width="100%" background="/images/shadow_box.gif"></td>
                                                                            <td><img src="/images/shadow_box_r.gif" border="0" width="5" height="12"></td>
                                                                        </tr>
                                                                    </table>
                                                                </div>
                                                                <div id="divExecution" runat="server" style="display:none">
                                                                    <br />
                                                                    <table width="100%" cellpadding="0" cellspacing="0" border="0">
                                                                        <tr>
                                                                            <td colspan="3" bgcolor="#6A8359" class="whitedefault"><div style="padding:3"><b>Execution</b></div></td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td colspan="3" style="border-left:solid 1px #999999;border-right:solid 1px #999999;border-top:solid 1px #999999;">
                                                                                <table width="100%" cellpadding="4" cellspacing="3" border="0" class="default">
                                                                                    <tr>
                                                                                        <td nowrap><b>Phase Start Date:</b></td>
                                                                                        <td width="50%"><asp:TextBox ID="txtCSRCSE" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgCSRCSE" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                                        <td nowrap><b>Internal Labor:</b></td>
                                                                                        <td width="50%"><asp:TextBox ID="txtCSRCIE" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgCSRCIE" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                                    </tr>
                                                                                    <tr>
                                                                                        <td nowrap><b>Phase End Date:</b></td>
                                                                                        <td width="50%"><asp:TextBox ID="txtCSRCEE" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgCSRCEE" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                                        <td nowrap><b>External Labor:</b></td>
                                                                                        <td width="50%"><asp:TextBox ID="txtCSRCExE" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgCSRCExE" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                                    </tr>
                                                                                    <tr>
                                                                                        <td nowrap>&nbsp;</td>
                                                                                        <td width="50%">&nbsp;</td>
                                                                                        <td nowrap><b>HW/SW/One Time Cost:</b></td>
                                                                                        <td width="50%"><asp:TextBox ID="txtCSRCHE" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgCSRCHE" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                                    </tr>
                                                                                </table>
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td><img src="/images/shadow_box_l.gif" border="0" width="5" height="12"></td>
                                                                            <td width="100%" background="/images/shadow_box.gif"></td>
                                                                            <td><img src="/images/shadow_box_r.gif" border="0" width="5" height="12"></td>
                                                                        </tr>
                                                                    </table>
                                                                </div>
                                                                <div id="divClosing" runat="server" style="display:none">
                                                                    <br />
                                                                    <table width="100%" cellpadding="0" cellspacing="0" border="0">
                                                                        <tr>
                                                                            <td colspan="3" bgcolor="#6A8359" class="whitedefault"><div style="padding:3"><b>Closing</b></div></td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td colspan="3" style="border-left:solid 1px #999999;border-right:solid 1px #999999;border-top:solid 1px #999999;">
                                                                                <table width="100%" cellpadding="4" cellspacing="3" border="0" class="default">
                                                                                    <tr>
                                                                                        <td nowrap><b>Phase Start Date:</b></td>
                                                                                        <td width="50%"><asp:TextBox ID="txtCSRCSC" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgCSRCSC" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                                        <td nowrap><b>Internal Labor:</b></td>
                                                                                        <td width="50%"><asp:TextBox ID="txtCSRCIC" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgCSRCIC" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                                    </tr>
                                                                                    <tr>
                                                                                        <td nowrap><b>Phase End Date:</b></td>
                                                                                        <td width="50%"><asp:TextBox ID="txtCSRCEC" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgCSRCEC" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                                        <td nowrap><b>External Labor:</b></td>
                                                                                        <td width="50%"><asp:TextBox ID="txtCSRCExC" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgCSRCExC" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                                    </tr>
                                                                                    <tr>
                                                                                        <td nowrap>&nbsp;</td>
                                                                                        <td width="50%">&nbsp;</td>
                                                                                        <td nowrap><b>HW/SW/One Time Cost:</b></td>
                                                                                        <td width="50%"><asp:TextBox ID="txtCSRCHC" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgCSRCHC" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                                    </tr>
                                                                                </table>
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td><img src="/images/shadow_box_l.gif" border="0" width="5" height="12"></td>
                                                                            <td width="100%" background="/images/shadow_box.gif"></td>
                                                                            <td><img src="/images/shadow_box_r.gif" border="0" width="5" height="12"></td>
                                                                        </tr>
                                                                    </table>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td colspan="2"><b>Approvals:</b></td>
                                                        </tr>
                                                        <tr>
                                                            <td colspan="2">
                                                                <table cellpadding="2" cellspacing="1" border="0" class="default">
                                                                    <tr>
                                                                        <td rowspan="5"><img src="/images/spacer.gif" border="0" width="15" height="1" /></td>
                                                                        <td class="greenheader"><b>Team Lead:</b></td>
                                                                        <td><asp:Label ID="lblTeamLeadCSRC" runat="server" CssClass="default" /></td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="greenheader"><b>Working Sponsor:</b></td>
                                                                        <td><asp:Label ID="lblCSRCW" runat="server" CssClass="default" /></td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="greenheader"><b>Executive Sponsor:</b></td>
                                                                        <td><asp:Label ID="lblCSRCE" runat="server" CssClass="default" /></td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="greenheader"><b>Director:</b></td>
                                                                        <td>
                                                                            <table cellpadding="0" cellspacing="0" border="0">
                                                                                <tr>
                                                                                    <td><asp:TextBox ID="txtCSRCD" runat="server" Width="200" CssClass="default" /></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td>
                                                                                        <div id="divCSRCD" runat="server" style="overflow:hidden; position:absolute; display:none; background-color:#FFFFFF; border:solid 1px #CCCCCC">
                                                                                            <asp:ListBox ID="lstCSRCD" runat="server" CssClass="default" />
                                                                                        </div>
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="greenheader"><b>CC:</b></td>
                                                                        <td>
                                                                            <table cellpadding="0" cellspacing="0" border="0">
                                                                                <tr>
                                                                                    <td><asp:TextBox ID="txtCSRCC" runat="server" Width="200" CssClass="default" /></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td>
                                                                                        <div id="divCSRCC" runat="server" style="overflow:hidden; position:absolute; display:none; background-color:#FFFFFF; border:solid 1px #CCCCCC">
                                                                                            <asp:ListBox ID="lstCSRCC" runat="server" CssClass="default" />
                                                                                        </div>
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td colspan="2" align="right"><asp:Button ID="btnCSRC" runat="server" CssClass="default" Text="Route for Approval" Width="150" OnClick="btnCSRC_Click" /></td>
                                                        </tr>
                                                    </table>
                                                </div>
                                                <table width="100%" cellpadding="3" cellspacing="0" border="0" class="default">
                                                    <tr bgcolor="#EEEEEE">
                                                        <td><b>Current CSRC Submissions</b></td>
                                                        <td><b>Status</b></td>
                                                        <td><b>Approved Date</b></td>
                                                        <td><b>Link</b></td>
                                                    </tr>
                                                    <%=strCSRC %>
                                                </table>
                                                <p><hr size="1" noshade /></p>
                                                <table width="100%" cellpadding="4" cellspacing="3" border="0" class="default">
                                                    <tr>
                                                        <td colspan="2" class="hugeheader">Project Change Request (PCR) Form</td>
                                                    </tr>
                                                    <tr>
                                                        <td nowrap><b>Show PCR Form:</b></td>
                                                        <td width="100%">
                                                            <asp:CheckBox ID="chkPCR" runat="server" CssClass="default" />
                                                        </td>
                                                    </tr>
                                                </table>
                                                <div id="divPCR" runat="server" style="display:none">
                                                    <table width="100%" cellpadding="4" cellspacing="3" border="0" class="default">
                                                        <tr>
                                                            <td colspan="2">
                                                                <table width="100%" cellpadding="0" cellspacing="0" border="0" class="default">
                                                                    <tr>
                                                                        <td colspan="3" bgcolor="#6A8359" class="whitedefault"><div style="padding:3"><b>Approved PCR Information</b></div></td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td colspan="3" style="border-left:solid 1px #999999;border-right:solid 1px #999999;border-top:solid 1px #999999;">
                                                                            <table width="100%" cellpadding="4" cellspacing="3" border="0" class="default">
                                                                                <tr>
                                                                                    <td nowrap><b>Scope:</b></td>
                                                                                    <td width="100%"><asp:CheckBox ID="chkScope" runat="server" CssClass="default" /></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td nowrap><b>Schedule:</b></td>
                                                                                    <td width="100%"><asp:CheckBox ID="chkSchedule" runat="server" CssClass="default" /></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td colspan="2">
                                                                                        <div id="divSchedule" runat="server" style="display:none">
                                                                                            <table width="100%" cellpadding="3" cellspacing="0" border="0" style="border:dashed 1px #CCCCCC">
                                                                                                <tr>
                                                                                                    <td class="greenheader"></td>
                                                                                                    <td class="greenheader"><b>Phase</b></td>
                                                                                                    <td class="greenheader"></td>
                                                                                                    <td class="greenheader" align="center"><b>Approved Dates</b></td>
                                                                                                    <td class="greenheader"></td>
                                                                                                    <td class="greenheader" align="center"><b>Modified Dates</b></td>
                                                                                                </tr>
                                                                                                <tr>
                                                                                                    <td><asp:CheckBox ID="chkPCRScheduleD" runat="server" CssClass="default" /></td>
                                                                                                    <td>Discovery</td>
                                                                                                    <td align="center"><img src="/images/green_arrow.gif" border="0" align="absmiddle" /></td>
                                                                                                    <td align="center"><asp:Label ID="lblPCRScheduleD" runat="server" CssClass="default" /></td>
                                                                                                    <td align="center"><img src="/images/green_arrow.gif" border="0" align="absmiddle" /></td>
                                                                                                    <td align="center"><asp:TextBox ID="txtPCRScheduleDS" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgPCRScheduleDS" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /> - <asp:TextBox ID="txtPCRScheduleDE" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgPCRScheduleDE" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                                                </tr>
                                                                                                <tr>
                                                                                                    <td><asp:CheckBox ID="chkPCRScheduleP" runat="server" CssClass="default" /></td>
                                                                                                    <td>Planning</td>
                                                                                                    <td align="center"><img src="/images/green_arrow.gif" border="0" align="absmiddle" /></td>
                                                                                                    <td align="center"><asp:Label ID="lblPCRScheduleP" runat="server" CssClass="default" /></td>
                                                                                                    <td align="center"><img src="/images/green_arrow.gif" border="0" align="absmiddle" /></td>
                                                                                                    <td align="center"><asp:TextBox ID="txtPCRSchedulePS" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgPCRSchedulePS" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /> - <asp:TextBox ID="txtPCRSchedulePE" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgPCRSchedulePE" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                                                </tr>
                                                                                                <tr>
                                                                                                    <td><asp:CheckBox ID="chkPCRScheduleE" runat="server" CssClass="default" /></td>
                                                                                                    <td>Execution</td>
                                                                                                    <td align="center"><img src="/images/green_arrow.gif" border="0" align="absmiddle" /></td>
                                                                                                    <td align="center"><asp:Label ID="lblPCRScheduleE" runat="server" CssClass="default" /></td>
                                                                                                    <td align="center"><img src="/images/green_arrow.gif" border="0" align="absmiddle" /></td>
                                                                                                    <td align="center"><asp:TextBox ID="txtPCRScheduleES" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgPCRScheduleES" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /> - <asp:TextBox ID="txtPCRScheduleEE" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgPCRScheduleEE" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                                                </tr>
                                                                                                <tr>
                                                                                                    <td><asp:CheckBox ID="chkPCRScheduleC" runat="server" CssClass="default" /></td>
                                                                                                    <td>Closing</td>
                                                                                                    <td align="center"><img src="/images/green_arrow.gif" border="0" align="absmiddle" /></td>
                                                                                                    <td align="center"><asp:Label ID="lblPCRScheduleC" runat="server" CssClass="default" /></td>
                                                                                                    <td align="center"><img src="/images/green_arrow.gif" border="0" align="absmiddle" /></td>
                                                                                                    <td align="center"><asp:TextBox ID="txtPCRScheduleCS" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgPCRScheduleCS" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /> - <asp:TextBox ID="txtPCRScheduleCE" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgPCRScheduleCE" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calendar.gif" /></td>
                                                                                                </tr>
                                                                                            </table>
                                                                                        </div>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td nowrap><b>Financial:</b></td>
                                                                                    <td width="100%"><asp:CheckBox ID="chkFinancial" runat="server" CssClass="default" /></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td colspan="2">
                                                                                        <div id="divFinancial" runat="server" style="display:none">
                                                                                            <table width="100%" cellpadding="3" cellspacing="0" border="0" style="border:dashed 1px #CCCCCC">
                                                                                                <tr>
                                                                                                    <td class="greenheader"></td>
                                                                                                    <td class="greenheader"><b>Phase</b></td>
                                                                                                    <td class="greenheader"></td>
                                                                                                    <td class="greenheader" align="center"><b>Approved Financials</b></td>
                                                                                                    <td class="greenheader"></td>
                                                                                                    <td class="greenheader" align="center"><b>Modified Financials</b></td>
                                                                                                </tr>
                                                                                                <tr>
                                                                                                    <td><asp:CheckBox ID="chkPCRFinancialD" runat="server" CssClass="default" /></td>
                                                                                                    <td>Discovery</td>
                                                                                                    <td align="center"><img src="/images/green_arrow.gif" border="0" align="absmiddle" /></td>
                                                                                                    <td align="center"><asp:Label ID="lblPCRFinancialD" runat="server" CssClass="default" /></td>
                                                                                                    <td align="center"><img src="/images/green_arrow.gif" border="0" align="absmiddle" /></td>
                                                                                                    <td align="center"><asp:TextBox ID="txtPCRFinancialD" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgPCRFinancialD" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                                                </tr>
                                                                                                <tr>
                                                                                                    <td><asp:CheckBox ID="chkPCRFinancialP" runat="server" CssClass="default" /></td>
                                                                                                    <td>Planning</td>
                                                                                                    <td align="center"><img src="/images/green_arrow.gif" border="0" align="absmiddle" /></td>
                                                                                                    <td align="center"><asp:Label ID="lblPCRFinancialP" runat="server" CssClass="default" /></td>
                                                                                                    <td align="center"><img src="/images/green_arrow.gif" border="0" align="absmiddle" /></td>
                                                                                                    <td align="center"><asp:TextBox ID="txtPCRFinancialP" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgPCRFinancialP" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                                                </tr>
                                                                                                <tr>
                                                                                                    <td><asp:CheckBox ID="chkPCRFinancialE" runat="server" CssClass="default" /></td>
                                                                                                    <td>Execution</td>
                                                                                                    <td align="center"><img src="/images/green_arrow.gif" border="0" align="absmiddle" /></td>
                                                                                                    <td align="center"><asp:Label ID="lblPCRFinancialE" runat="server" CssClass="default" /></td>
                                                                                                    <td align="center"><img src="/images/green_arrow.gif" border="0" align="absmiddle" /></td>
                                                                                                    <td align="center"><asp:TextBox ID="txtPCRFinancialE" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgPCRFinancialE" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                                                </tr>
                                                                                                <tr>
                                                                                                    <td><asp:CheckBox ID="chkPCRFinancialC" runat="server" CssClass="default" /></td>
                                                                                                    <td>Closing</td>
                                                                                                    <td align="center"><img src="/images/green_arrow.gif" border="0" align="absmiddle" /></td>
                                                                                                    <td align="center"><asp:Label ID="lblPCRFinancialC" runat="server" CssClass="default" /></td>
                                                                                                    <td align="center"><img src="/images/green_arrow.gif" border="0" align="absmiddle" /></td>
                                                                                                    <td align="center"><asp:TextBox ID="txtPCRFinancialC" runat="server" CssClass="default" Width="100" MaxLength="10" /> <asp:ImageButton ID="imgPCRFinancialC" runat="server" ImageAlign="AbsMiddle" ImageUrl="/images/calculator.gif" /></td>
                                                                                                </tr>
                                                                                            </table>
                                                                                        </div>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td nowrap><b>Reason for PCR:</b></td>
                                                                                    <td width="100%"><asp:CheckBox ID="chkReason" runat="server" CssClass="default" /></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td colspan="2">
                                                                                        <div id="divReason" runat="server" style="display:none">
                                                                                        <asp:CheckBoxList ID="chkPCRReason" runat="server" CssClass="default" RepeatColumns="3" RepeatDirection="horizontal">
                                                                                            <asp:ListItem Value="Resource Constraints (internal and external)" />
                                                                                            <asp:ListItem Value="Estimates" />
                                                                                            <asp:ListItem Value="Scope change" />
                                                                                            <asp:ListItem Value="Vendor issues" />
                                                                                            <asp:ListItem Value="Technical issues" />
                                                                                            <asp:ListItem Value="Dependencies (other projects or other...)" />
                                                                                            <asp:ListItem Value="Unknown components" />
                                                                                            <asp:ListItem Value="Unknown resources" />
                                                                                            <asp:ListItem Value="IP/Audit requirements" />
                                                                                            <asp:ListItem Value="Prioritization change" />
                                                                                            <asp:ListItem Value="Sponsor mis-communication" />
                                                                                        </asp:CheckBoxList>
                                                                                        </div>
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td nowrap><b>PCR Document:</b></td>
                                                                                    <td width="100%"><asp:FileUpload runat="server" ID="oPCR" Width="500" CssClass="default" /></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td colspan="2"><b>Approvals:</b></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td colspan="2">
                                                                                        <table cellpadding="2" cellspacing="1" border="0" class="default">
                                                                                            <tr>
                                                                                                <td rowspan="5"><img src="/images/spacer.gif" border="0" width="15" height="1" /></td>
                                                                                                <td class="greenheader"><b>Team Lead:</b></td>
                                                                                                <td><asp:Label ID="lblTeamLeadPCR" runat="server" CssClass="default" /></td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td class="greenheader"><b>Working Sponsor:</b></td>
                                                                                                <td><asp:Label ID="lblPCRW" runat="server" CssClass="default" /></td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td class="greenheader"><b>Executive Sponsor:</b></td>
                                                                                                <td><asp:Label ID="lblPCRE" runat="server" CssClass="default" /></td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td class="greenheader"><b>Director:</b></td>
                                                                                                <td>
                                                                                                    <table cellpadding="0" cellspacing="0" border="0">
                                                                                                        <tr>
                                                                                                            <td><asp:TextBox ID="txtPCRD" runat="server" Width="200" CssClass="default" /></td>
                                                                                                        </tr>
                                                                                                        <tr>
                                                                                                            <td>
                                                                                                                <div id="divPCRD" runat="server" style="overflow:hidden; position:absolute; display:none; background-color:#FFFFFF; border:solid 1px #CCCCCC">
                                                                                                                    <asp:ListBox ID="lstPCRD" runat="server" CssClass="default" />
                                                                                                                </div>
                                                                                                            </td>
                                                                                                        </tr>
                                                                                                    </table>
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td class="greenheader"><b>CC:</b></td>
                                                                                                <td>
                                                                                                    <table cellpadding="0" cellspacing="0" border="0">
                                                                                                        <tr>
                                                                                                            <td><asp:TextBox ID="txtPCRC" runat="server" Width="200" CssClass="default" /></td>
                                                                                                        </tr>
                                                                                                        <tr>
                                                                                                            <td>
                                                                                                                <div id="divPCRC" runat="server" style="overflow:hidden; position:absolute; display:none; background-color:#FFFFFF; border:solid 1px #CCCCCC">
                                                                                                                    <asp:ListBox ID="lstPCRC" runat="server" CssClass="default" />
                                                                                                                </div>
                                                                                                            </td>
                                                                                                        </tr>
                                                                                                    </table>
                                                                                                </td>
                                                                                            </tr>
                                                                                        </table>
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td><img src="/images/shadow_box_l.gif" border="0" width="5" height="12"></td>
                                                                        <td width="100%" background="/images/shadow_box.gif"></td>
                                                                        <td><img src="/images/shadow_box_r.gif" border="0" width="5" height="12"></td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td colspan="2" align="right"><asp:Button ID="btnPCR" runat="server" CssClass="default" Text="Route for Approval" Width="150" OnClick="btnPCR_Click" /></td>
                                                        </tr>
                                                    </table>
    		                                    </div>
                                                <table width="100%" cellpadding="3" cellspacing="0" border="0" class="default">
                                                    <tr bgcolor="#EEEEEE">
                                                        <td><b>Current PCR Submissions</b></td>
                                                        <td><b>Status</b></td>
                                                        <td><b>Approved Date</b></td>
                                                        <td align="center"><b>Scope Change</b></td>
                                                        <td align="center"><b>Schedule Change</b></td>
                                                        <td align="center"><b>Financial Change</b></td>
                                                        <td><b>Link</b></td>
                                                    </tr>
                                                    <%=strPCR %>
                                                </table>
    		                                </div>
		                                    <div id="divClose" style='<%=boolClose == true ? "display:inline" : "display:none" %>'>
		                                        <br />
                                                <table width="100%" cellpadding="4" cellspacing="3" border="0" class="default">
                                                    <tr>
                                                        <td colspan="2">&nbsp;</td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2"><b>Results Better than Expected:</b></td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2"><asp:TextBox ID="CV_FIELD_10088" runat="server" CssClass="default" Width="400" TextMode="MultiLine" Rows="5" /></td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2"><b>Results Worse than Expected:</b></td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2"><asp:TextBox ID="CV_FIELD_10089" runat="server" CssClass="default" Width="400" TextMode="MultiLine" Rows="5" /></td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2"><b>Lessons Learned:</b></td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2"><asp:TextBox ID="CV_FIELD_10090" runat="server" CssClass="default" Width="400" TextMode="MultiLine" Rows="5" /></td>
                                                    </tr>
                                                    <tr><td colspan="2">&nbsp;</td></tr>
                                                    <tr>
                                                        <td colspan="2">
                                                            <table cellpadding="3" cellspacing="2" border="0"  class="offsettable">
                                                                <tr>
                                                                    <td colspan="7" class="greentableheader">Overall Financials:</td>
                                                                </tr>
                                                                <tr>
                                                                    <td>&nbsp;</td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center"><b>Approved</b></td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center"><b>Actual</b></td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center"><b>Variance</b></td>
                                                                </tr>
                                                                <tr>
                                                                    <td nowrap>Internal Labor</td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center">$<asp:Label ID="lblApprovedI" runat="server" CssClass="default" /></td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center">$<asp:Label ID="lblActualI" runat="server" CssClass="default" /></td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center">$<asp:Label ID="lblVarianceI" runat="server" CssClass="default" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td nowrap>External Labor</td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center">$<asp:Label ID="lblApprovedE" runat="server" CssClass="default" /></td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center">$<asp:Label ID="lblActualE" runat="server" CssClass="default" /></td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center">$<asp:Label ID="lblVarianceE" runat="server" CssClass="default" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td nowrap>Capital (HW / SW)</td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center">$<asp:Label ID="lblApprovedC" runat="server" CssClass="default" /></td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center">$<asp:Label ID="lblActualC" runat="server" CssClass="default" /></td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center">$<asp:Label ID="lblVarianceC" runat="server" CssClass="default" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td colspan="7" style="border-top:solid 1px #CCCCCC"><img src="/images/spacer.gif" border="0" width="1" height="1" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td nowrap align="right"><b>Total:</b></td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center"><b>$<asp:Label ID="lblApproved" runat="server" CssClass="default" /></b></td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center"><b>$<asp:Label ID="lblActual" runat="server" CssClass="default" /></b></td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center"><b>$<asp:Label ID="lblVariance" runat="server" CssClass="default" /></b></td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2">&nbsp;</td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2">
                                                            <table cellpadding="3" cellspacing="2" border="0"  class="offsettable">
                                                                <tr>
                                                                    <td colspan="7" class="greentableheader">Overall Schedule:</td>
                                                                </tr>
                                                                <tr>
                                                                    <td>&nbsp;</td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center"><b>Approved</b></td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center"><b>Actual</b></td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center"><b>Variance</b></td>
                                                                </tr>
                                                                <tr>
                                                                    <td nowrap>Start Date</td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center"><asp:Label ID="lblApprovedS" runat="server" CssClass="default" /></td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center"><asp:Label ID="lblActualS" runat="server" CssClass="default" /></td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center"><asp:Label ID="lblVarianceS" runat="server" CssClass="default" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td nowrap>End Date</td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center"><asp:Label ID="lblApprovedF" runat="server" CssClass="default" /></td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center"><asp:Label ID="lblActualF" runat="server" CssClass="default" /></td>
                                                                    <td>&nbsp;</td>
                                                                    <td align="center"><asp:Label ID="lblVarianceF" runat="server" CssClass="default" /></td>
                                                                </tr>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </table>
		                                    </div>
		                                </td>
		                            </tr>
		                        </table>
		                    </td>
	                    </tr>
	                </table>
            </td>
        </tr>
    </table>
</asp:Panel>
<asp:Panel ID="panDenied" runat="server" Visible="false">
    <table width="100%" cellpadding="2" cellspacing="2" border="0">
        <tr>
            <td><img src="/images/spacer.gif" border="0" width="15" height="1" /></td>
            <td class="header"><img src="/images/bigX.gif" border="0" align="absmiddle" /> Access Denied</td>
        </tr>
        <tr><td colspan="2">&nbsp;</td></tr>
        <tr>
            <td><img src="/images/spacer.gif" border="0" width="15" height="1" /></td>
            <td>You do not have rights to view this item.</td>
        </tr>
        <tr><td colspan="2">&nbsp;</td></tr>
        <tr>
            <td colspan="2"><hr size="1" noshade /></td>
        </tr>
        <tr>
            <td colspan="2" align="right">
                <table width="100%" cellpadding="0" cellspacing="0" border="0">
                    <tr>
                        <td class="footer"></td>
                        <td align="right"><asp:Button ID="btnDenied" runat="server" CssClass="default" Width="75" Text="Close" /></td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</asp:Panel>
<asp:Label ID="lblRequest" runat="server" Visible="false" />
<asp:HiddenField ID="hdnExecutive" runat="server" />
<asp:HiddenField ID="hdnWorking" runat="server" />
<asp:HiddenField ID="hdnCSRCD" runat="server" />
<asp:HiddenField ID="hdnPCRD" runat="server" />
<asp:HiddenField ID="hdnCSRCC" runat="server" />
<asp:HiddenField ID="hdnPCRC" runat="server" />
<asp:HiddenField ID="hdnTab" runat="server" />
<asp:HiddenField ID="CV_FIELD_10059" runat="server" />